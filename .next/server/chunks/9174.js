"use strict";exports.id=9174,exports.ids=[9174],exports.modules={6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})},7673:(e,t,i)=>{i.d(t,{Z:()=>s});class a{constructor(){this.tests=new Map,this.results=[],this.userAssignments=new Map,this.initializeDefaultTests()}initializeDefaultTests(){let e={id:"recommendation_strategies_2025",name:"Recommendation Strategy Optimization",description:"Compare different recommendation approaches for effectiveness",status:"active",startDate:"2025-08-01T00:00:00Z",endDate:"2025-12-31T23:59:59Z",targetMetrics:["click_through_rate","completion_rate","user_satisfaction","recommendation_diversity"],trafficAllocation:.8,variants:[{id:"control_content_based",name:"Control: Content-Based",weight:.25,config:{strategy:"content-based",parameters:{riskLevelWeight:.4,languageWeight:.3,culturalWeight:.2,locationWeight:.1}}},{id:"enhanced_collaborative",name:"Enhanced Collaborative Filtering",weight:.25,config:{strategy:"collaborative",parameters:{minSimilarUsers:5,similarityThreshold:.3,decayFactor:.95,diversityBoost:.1}}},{id:"cultural_priority",name:"Cultural-Priority Matching",weight:.25,config:{strategy:"demographic",parameters:{culturalWeight:.4,languageWeight:.3,countryWeight:.2,employmentWeight:.1}}},{id:"ml_optimized",name:"ML-Optimized Hybrid",weight:.25,config:{strategy:"hybrid",parameters:{learningRate:.01,explorationRate:.1,adaptationSpeed:.05},modelWeights:{contentBased:.3,collaborative:.25,demographic:.2,mlPredicted:.25}}}],statisticalConfig:{minSampleSize:100,confidenceLevel:.95,minDetectableEffect:.05,power:.8}};this.tests.set(e.id,e);let t={id:"crisis_optimization_2025",name:"Crisis Resource Prioritization",description:"Optimize how crisis resources are recommended to high-risk users",status:"active",startDate:"2025-08-01T00:00:00Z",targetMetrics:["crisis_resource_utilization","follow_up_engagement","safety_metrics"],trafficAllocation:1,includeCriteria:{riskLevels:["severe"]},variants:[{id:"immediate_crisis_focus",name:"Immediate Crisis Focus",weight:.5,config:{strategy:"content-based",parameters:{crisisResourcePriority:.8,urgencyMultiplier:2,diversityReduction:.5}}},{id:"balanced_crisis_support",name:"Balanced Crisis + Support",weight:.5,config:{strategy:"hybrid",parameters:{crisisResourcePriority:.6,supportResourceMix:.4,urgencyMultiplier:1.5}}}],statisticalConfig:{minSampleSize:50,confidenceLevel:.95,minDetectableEffect:.1,power:.8}};this.tests.set(t.id,t)}assignUserToTest(e,t){let i=this.userAssignments.get(e);if(i)return i;let a=Array.from(this.tests.values()).filter(e=>"active"===e.status&&this.isUserEligible(e,t));if(0===a.length)return null;let s=a[0],r=this.hashUserId(e);if(r>s.trafficAllocation)return null;let n=this.selectVariant(s,r),o={testId:s.id,variantId:n};return this.userAssignments.set(e,o),o}isUserEligible(e,t){let i=e.includeCriteria;return!i||(!i.riskLevels||!!i.riskLevels.includes(t.riskLevel))&&(!i.countries||!!i.countries.includes(t.demographics.location?.country))&&(!i.employmentSectors||!!i.employmentSectors.includes(t.demographics.employmentSector))&&(!i.languages||!!i.languages.includes(t.demographics.language))&&(!i.minSessions||!(t.usagePatterns.totalSessions<i.minSessions))}hashUserId(e){let t=0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t&=t;return Math.abs(t)/2147483647}selectVariant(e,t){let i=0,a=e.variants.reduce((e,t)=>e+t.weight,0);for(let s of e.variants)if(t<=(i+=s.weight/a))return s.id;return e.variants[e.variants.length-1].id}recordResult(e){this.results.push({...e,timestamp:new Date().toISOString()})}getTestConfig(e,t){let i=this.tests.get(e);if(!i)return null;let a=i.variants.find(e=>e.id===t);return a?.config||null}getTestAnalytics(e,t){let i=this.tests.get(e);if(!i)return null;let a=this.results.filter(t=>t.testId===e);t&&(a=a.filter(e=>new Date(e.timestamp)>=new Date(t.start)&&new Date(e.timestamp)<=new Date(t.end)));let s=new Map;for(let e of i.variants){let t=a.filter(t=>t.variantId===e.id);if(0===t.length){s.set(e.id,{name:e.name,sampleSize:0,metrics:{}});continue}let r={click_through_rate:this.calculateMean(t.map(e=>e.recommendationsShown>0?e.recommendationsClicked/e.recommendationsShown:0)),completion_rate:this.calculateMean(t.map(e=>e.recommendationsClicked>0?e.recommendationsCompleted/e.recommendationsClicked:0)),user_satisfaction:this.calculateMean(t.filter(e=>e.satisfactionRating).map(e=>e.satisfactionRating)),recommendation_diversity:this.calculateDiversity(t),avg_session_duration:this.calculateMean(t.map(e=>e.sessionDuration))},n=this.calculateConfidenceInterval(t.map(e=>e.primaryMetric),i.statisticalConfig.confidenceLevel);s.set(e.id,{name:e.name,sampleSize:t.length,metrics:r,confidence:n,statisticalSignificance:this.calculateStatisticalSignificance(t,i)})}return{testId:e,testName:i.name,status:i.status,variants:Object.fromEntries(s),overallResults:this.calculateOverallTestResults(a,i),recommendations:this.generateTestRecommendations(s,i)}}calculateMean(e){return 0===e.length?0:e.reduce((e,t)=>e+t,0)/e.length}calculateDiversity(e){return new Set(e.map(e=>e.userId)).size/Math.max(e.length,1)}calculateConfidenceInterval(e,t){if(0===e.length)return{lower:0,upper:0};let i=this.calculateMean(e),a=Math.sqrt(e.reduce((e,t)=>e+Math.pow(t-i,2),0)/e.length)/Math.sqrt(e.length)*1.96;return{lower:Math.max(0,i-a),upper:Math.min(1,i+a)}}calculateStatisticalSignificance(e,t){return e.length>=t.statisticalConfig.minSampleSize}calculateOverallTestResults(e,t){return{totalParticipants:new Set(e.map(e=>e.userId)).size,totalInteractions:e.length,testDuration:t.endDate?Math.ceil((new Date(t.endDate).getTime()-new Date(t.startDate).getTime())/864e5):Math.ceil((Date.now()-new Date(t.startDate).getTime())/864e5)}}generateTestRecommendations(e,t){let i=[],a="",s=-1;for(let[t,i]of e.entries()){let e=i.metrics.click_through_rate||0;e>s&&i.sampleSize>=30&&(s=e,a=i.name)}return a&&i.push(`Consider implementing ${a} as the primary strategy`),Array.from(e.values()).some(e=>e.statisticalSignificance)||i.push("Continue test to reach statistical significance"),Array.from(e.values()).some(e=>e.confidence&&e.confidence.upper-e.confidence.lower>.2)&&i.push("Increase sample size to reduce confidence interval width"),i}createTest(e){this.tests.set(e.id,e)}updateTestStatus(e,t){let i=this.tests.get(e);i&&(i.status=t,"completed"===t&&(i.endDate=new Date().toISOString()))}getActiveTests(){return Array.from(this.tests.values()).filter(e=>"active"===e.status)}exportResults(e){return e?this.results.filter(t=>t.testId===e):[...this.results]}}let s=a},2830:(e,t,i)=>{i.d(t,{Z:()=>s});class a{constructor(){this.resources=[],this.userProfiles=new Map,this.interactions=[],this.abTests=new Map,this.metrics=[],this.modelWeights={phq4ScoreWeight:.25,demographicWeight:.2,culturalWeight:.15,collaborativeWeight:.2,usagePatternWeight:.1,recencyWeight:.1},this.initializeResources(),this.initializeABTests()}async getRecommendations(e){let{userProfile:t,context:i,abTestGroup:a}=e,s=this.getRecommendationStrategy(t,a),r=[];switch(s){case"content-based":r=await this.getContentBasedRecommendations(t,i);break;case"collaborative":r=await this.getCollaborativeRecommendations(t,i);break;case"demographic":r=await this.getDemographicRecommendations(t,i);break;case"ml-predicted":r=await this.getMLPredictedRecommendations(t,i);break;default:r=await this.getHybridRecommendations(t,i)}return r=(r=this.applyContextFilters(r,i)).sort((e,t)=>t.score-e.score).slice(0,i.maxRecommendations),r=this.addPersonalizedMessages(r,t),this.logRecommendationMetrics(r,t,s,a),r}async getContentBasedRecommendations(e,t){let i=[],a=e.phq4Scores.latest;for(let t of this.resources){let s=0,r=[];t.metadata.riskLevels.includes(a.riskLevel)&&(s+=.3,r.push(`Suitable for ${a.riskLevel} risk level`)),t.metadata.languages.includes(e.demographics.language)&&(s+=.2,r.push(`Available in ${e.demographics.language}`));let n=e.demographics.countryOfOrigin;n&&t.metadata.culturalContext.includes(n)&&(s+=.15,r.push(`Culturally appropriate for ${n}`));let o=t.metadata.targetDemographics;o.ageGroups?.includes(e.demographics.ageGroup||"")&&(s+=.1,r.push("Age-appropriate content")),o.employmentSectors?.includes(e.demographics.employmentSector||"")&&(s+=.1,r.push("Relevant to your work situation"));let l=e.demographics.location?.country;l&&t.availability.locations.includes(l)&&(s+=.15,r.push("Available in your location")),s>.3&&i.push({resource:t,score:s,reasons:r,strategy:"content-based",urgency:this.calculateUrgency(a.riskLevel,t.type),estimatedHelpfulness:this.estimateHelpfulness(t,e)})}return i}async getCollaborativeRecommendations(e,t){let i=[],a=this.findSimilarUsers(e),s=new Map;for(let e of a){let t=e.similarity;for(let i of e.profile.interactionHistory)if("rate"===i.type&&i.rating&&i.rating>=4){let e=s.get(i.resourceId)||{score:0,count:0,reasons:new Set};e.score+=i.rating/5*t,e.count+=1,e.reasons.add("Highly rated by users with similar background"),s.set(i.resourceId,e)}}for(let[t,a]of s.entries()){let s=this.resources.find(e=>e.id===t);if(s&&a.count>=3){let t=a.score/a.count;i.push({resource:s,score:t,reasons:Array.from(a.reasons),strategy:"collaborative",urgency:this.calculateUrgency(e.phq4Scores.latest.riskLevel,s.type),estimatedHelpfulness:t})}}return i}async getDemographicRecommendations(e,t){let i=[],a=e.demographics;for(let t of this.resources){let s=0,r=[];a.countryOfOrigin&&t.metadata.targetDemographics.countries?.includes(a.countryOfOrigin)&&(s+=.3,r.push(`Designed for ${a.countryOfOrigin} nationals`)),a.employmentSector&&t.metadata.targetDemographics.employmentSectors?.includes(a.employmentSector)&&(s+=.25,r.push(`Tailored for ${a.employmentSector} workers`)),a.ageGroup&&t.metadata.targetDemographics.ageGroups?.includes(a.ageGroup)&&(s+=.2,r.push("Appropriate for your age group")),a.gender&&t.metadata.targetDemographics.genders?.includes(a.gender)&&(s+=.15,r.push("Gender-specific content")),t.metadata.languages.includes(a.language)&&(s+=.1,r.push(`Available in ${a.language}`)),s>.4&&i.push({resource:t,score:s,reasons:r,strategy:"demographic",urgency:this.calculateUrgency(e.phq4Scores.latest.riskLevel,t.type),estimatedHelpfulness:this.estimateHelpfulness(t,e)})}return i}async getMLPredictedRecommendations(e,t){let i=[],a=this.extractUserFeatures(e);for(let t of this.resources){let s=this.extractResourceFeatures(t),r=this.predictResourceFit(a,s);r.score>.5&&i.push({resource:t,score:r.score,reasons:r.reasons,strategy:"ml-predicted",urgency:this.calculateUrgency(e.phq4Scores.latest.riskLevel,t.type),estimatedHelpfulness:r.score})}return i}async getHybridRecommendations(e,t){let i=await this.getContentBasedRecommendations(e,t),a=await this.getCollaborativeRecommendations(e,t),s=await this.getDemographicRecommendations(e,t),r=await this.getMLPredictedRecommendations(e,t),n=new Map;for(let e of[...i.map(e=>({...e,strategy:"content-based"})),...a.map(e=>({...e,strategy:"collaborative"})),...s.map(e=>({...e,strategy:"demographic"})),...r.map(e=>({...e,strategy:"ml-predicted"}))]){let t=e.resource.id,i=n.get(t)||{resource:e.resource,scores:{},reasons:new Set};i.scores[e.strategy]=e.score,e.reasons.forEach(e=>i.reasons.add(e)),n.set(t,i)}let o=[],l={"content-based":.3,collaborative:.25,demographic:.2,"ml-predicted":.25};for(let[t,i]of n.entries()){let t=0,a=0;for(let[e,s]of Object.entries(i.scores)){let i=l[e]||0;t+=s*i,a+=i}a>0&&(t/=a,o.push({resource:i.resource,score:t,reasons:Array.from(i.reasons),strategy:"hybrid",urgency:this.calculateUrgency(e.phq4Scores.latest.riskLevel,i.resource.type),estimatedHelpfulness:t}))}return o}findSimilarUsers(e){let t=[];for(let[i,a]of this.userProfiles.entries()){if(a.anonymousId===e.anonymousId)continue;let i=this.calculateUserSimilarity(e,a);i>.3&&t.push({profile:a,similarity:i})}return t.sort((e,t)=>t.similarity-e.similarity).slice(0,20)}calculateUserSimilarity(e,t){let i;return i=0+(1-Math.abs(e.phq4Scores.latest.totalScore-t.phq4Scores.latest.totalScore)/12)*.3,e.demographics.countryOfOrigin===t.demographics.countryOfOrigin&&(i+=.2),e.demographics.ageGroup===t.demographics.ageGroup&&(i+=.15),e.demographics.employmentSector===t.demographics.employmentSector&&(i+=.15),e.demographics.language===t.demographics.language&&(i+=.1),e.demographics.gender===t.demographics.gender&&(i+=.1),Math.min(i,1)}extractUserFeatures(e){return[e.phq4Scores.latest.totalScore/12,e.phq4Scores.latest.depressionScore/6,e.phq4Scores.latest.anxietyScore/6,e.usagePatterns.assessmentFrequency/10,e.usagePatterns.totalSessions/100,e.usagePatterns.sessionDuration/60,this.encodeRiskLevel(e.phq4Scores.latest.riskLevel),this.encodeCategory(e.demographics.ageGroup||"",["18-25","26-35","36-45","46-55","55+"]),this.encodeCategory(e.demographics.countryOfOrigin||"",["Bangladesh","India","Philippines","Indonesia","Myanmar"])]}extractResourceFeatures(e){return[e.effectiveness.averageRating/5,e.effectiveness.completionRate,e.effectiveness.improvementScore/12,e.metadata.duration/120,this.encodeCategory(e.metadata.difficulty,["beginner","intermediate","advanced"]),this.encodeCategory(e.type,["therapy","self-help","peer-support","medication","crisis","wellness"])]}predictResourceFit(e,t){let i=0,a=[];e[3]>.7&&t[5]>.8&&(i+=.4,a.push("Matched based on urgency indicators"));let s=e[4],r=t[4];s>.5&&r>.6&&(i+=.2,a.push("Suitable complexity for active users"));let n=t[0];return i+=.3*n,n>.8&&a.push("Highly effective based on user feedback"),{score:Math.min(i+=.1*Math.random(),1),reasons:a}}calculateUrgency(e,t){return"severe"===e&&"crisis"===t?"urgent":"severe"===e?"high":"moderate"===e?"medium":"low"}estimateHelpfulness(e,t){let i=e.effectiveness.averageRating/5,a=t.phq4Scores.latest.riskLevel;return e.metadata.riskLevels.includes(a)&&(i+=.2),e.metadata.languages.includes(t.demographics.language)&&(i+=.1),Math.min(i,1)}encodeRiskLevel(e){return({minimal:.25,mild:.5,moderate:.75,severe:1})[e]||0}encodeCategory(e,t){let i=t.indexOf(e);return i>=0?(i+1)/t.length:0}getRecommendationStrategy(e,t){if(!t)return"hybrid";let i=Array.from(this.abTests.values()).find(e=>e.active&&e.trafficSplit[t]);return i&&i.variants[t]?i.variants[t].strategy:"hybrid"}applyContextFilters(e,t){let i=e;if(t.includeTypes?.length&&(i=i.filter(e=>t.includeTypes.includes(e.resource.type))),t.excludeTypes?.length&&(i=i.filter(e=>!t.excludeTypes.includes(e.resource.type))),t.urgencyFilter){let e={low:1,medium:2,high:3,urgent:4},a=e[t.urgencyFilter];i=i.filter(t=>e[t.urgency]>=a)}return i}addPersonalizedMessages(e,t){return e.map(e=>{t.phq4Scores.latest.riskLevel;let i=t.demographics.countryOfOrigin,a="";return"urgent"===e.urgency?a="This resource provides immediate support for your current situation.":"collaborative"===e.strategy?a="People with similar backgrounds have found this helpful.":"demographic"===e.strategy&&i?a=`This resource is specifically designed for people from ${i}.`:e.resource.effectiveness.averageRating>4.5&&(a="This is a highly-rated resource that has helped many people."),{...e,personalizedMessage:a}})}logRecommendationMetrics(e,t,i,a){e.forEach((e,s)=>{let r={recommendationId:`rec_${Date.now()}_${s}`,userId:t.anonymousId,timestamp:new Date().toISOString(),strategy:i,abTestGroup:a,resourceId:e.resource.id,score:e.score,position:s,viewed:!1,clicked:!1,completed:!1,triggerContext:"system_generated",userRiskLevel:t.phq4Scores.latest.riskLevel,timeOfDay:new Date().getHours().toString()};this.metrics.push(r)})}trackInteraction(e,t,i){let a=this.metrics.find(t=>t.recommendationId===e);if(a)switch(t){case"view":a.viewed=!0;break;case"click":a.clicked=!0,a.timeToClick=i?.timeToClick;break;case"complete":a.completed=!0,a.engagementDuration=i?.duration;break;case"rate":a.rating=i?.rating,a.helpfulnessRating=i?.helpfulness}}initializeResources(){this.resources=[{id:"res_001",type:"therapy",title:"Multilingual Counseling Services",description:"Professional counseling available in multiple languages for migrant workers",metadata:{languages:["en","zh","bn","ta","my","idn"],culturalContext:["Bangladesh","India","Philippines","Indonesia","Myanmar"],targetDemographics:{employmentSectors:["Construction","Domestic Work","Manufacturing"],countries:["Singapore","Malaysia","UAE","Saudi Arabia"]},riskLevels:["moderate","severe"],tags:["professional","culturally-sensitive","confidential"],difficulty:"beginner",duration:60,format:"individual"},effectiveness:{averageRating:4.3,totalRatings:127,completionRate:.78,improvementScore:3.2},availability:{locations:["Singapore","Malaysia","UAE"],cost:"free",accessRequirements:["appointment"],waitTime:3},provider:{name:"Migrant Mental Health Collective",type:"ngo",credentials:["Licensed Therapists","Cultural Specialists"],contact:{phone:"+65-1234-5678",email:"help@mmhc.org",whatsapp:"+65-1234-5678"}}}]}initializeABTests(){this.abTests.set("recommendation_strategy_test",{id:"recommendation_strategy_test",name:"Recommendation Strategy Comparison",description:"Testing different recommendation approaches",active:!0,trafficSplit:{control:25,ml_enhanced:25,cultural_first:25,collaborative_heavy:25},startDate:"2025-08-01",metrics:["click_through_rate","completion_rate","satisfaction_rating"],variants:{control:{strategy:"content-based",weights:{content:1},parameters:{}},ml_enhanced:{strategy:"ml-predicted",weights:{ml:.6,content:.4},parameters:{exploration_rate:.1}},cultural_first:{strategy:"demographic",weights:{demographic:.6,cultural:.4},parameters:{cultural_weight:2}},collaborative_heavy:{strategy:"hybrid",weights:{collaborative:.5,content:.3,demographic:.2},parameters:{min_similar_users:5}}}})}getAnalytics(e){let t=this.metrics;e&&(t=t.filter(t=>new Date(t.timestamp)>=new Date(e.start)&&new Date(t.timestamp)<=new Date(e.end)));let i=t.length,a=t.filter(e=>e.clicked).length,s=t.filter(e=>e.completed).length,r=new Map;for(let e of["content-based","collaborative","demographic","ml-predicted","hybrid"]){let i=t.filter(t=>t.strategy===e),a=i.filter(e=>e.clicked).length,s=i.filter(e=>e.completed).length,n=i.filter(e=>e.rating).reduce((e,t)=>e+(t.rating||0),0)/i.filter(e=>e.rating).length;r.set(e,{totalRecommendations:i.length,clickThroughRate:i.length>0?a/i.length:0,completionRate:i.length>0?s/i.length:0,averageRating:n||0})}return{overview:{totalRecommendations:i,clickThroughRate:i>0?a/i:0,completionRate:i>0?s/i:0},strategyPerformance:Object.fromEntries(r),abTestResults:this.getABTestResults()}}getABTestResults(){let e=new Map;for(let[t,i]of this.abTests.entries()){let a=this.metrics.filter(e=>e.abTestGroup),s=new Map;for(let e of Object.keys(i.variants)){let t=a.filter(t=>t.abTestGroup===e),i=t.filter(e=>e.clicked).length,r=t.filter(e=>e.completed).length;s.set(e,{sample_size:t.length,click_through_rate:t.length>0?i/t.length:0,completion_rate:t.length>0?r/t.length:0})}e.set(t,{test_name:i.name,status:i.active?"active":"inactive",variants:Object.fromEntries(s)})}return Object.fromEntries(e)}}let s=a},7153:(e,t)=>{var i;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return i}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(i||(i={}))},1802:(e,t,i)=>{e.exports=i(145)}};