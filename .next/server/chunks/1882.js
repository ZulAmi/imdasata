exports.id=1882,exports.ids=[1882],exports.modules={1323:(e,s)=>{"use strict";Object.defineProperty(s,"l",{enumerable:!0,get:function(){return function e(s,t){return t in s?s[t]:"then"in s&&"function"==typeof s.then?s.then(s=>e(s,t)):"function"==typeof s&&"default"===t?s:void 0}}})},7338:(e,s,t)=>{"use strict";t.d(s,{Z:()=>o});var r=t(997),a=t(6689),i=t(1377);let n=({message:e,isOwnMessage:s,getUserDisplayName:t,onAddReaction:i,formatTime:n})=>{let[l,o]=(0,a.useState)(!1);return"system"===e.type?r.jsx("div",{className:"text-center",children:r.jsx("span",{className:"text-sm text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:e.content})}):r.jsx("div",{className:`flex ${s?"justify-end":"justify-start"}`,children:(0,r.jsxs)("div",{className:`max-w-xs lg:max-w-md ${s?"order-1":"order-2"}`,children:[(0,r.jsxs)("div",{className:`px-4 py-2 rounded-lg ${s?"bg-blue-600 text-white":"bg-white border border-gray-200"}`,children:[!s&&r.jsx("div",{className:"text-xs text-gray-500 mb-1",children:t(e.senderId)}),"voice"===e.type&&e.voiceData?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{className:"text-lg",children:"\uD83C\uDFB5"}),r.jsx("div",{className:"flex-1",children:r.jsx("audio",{controls:!0,src:e.voiceData.audioUrl,className:"w-full"})})]}):r.jsx("div",{children:e.content}),r.jsx("div",{className:"flex items-center justify-between mt-1",children:r.jsx("span",{className:`text-xs ${s?"text-blue-100":"text-gray-500"}`,children:n(e.timestamp)})})]}),e.reactions.length>0&&r.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Array.from(new Set(e.reactions.map(e=>e.emoji))).map(s=>{let t=e.reactions.filter(e=>e.emoji===s).length;return(0,r.jsxs)("button",{onClick:()=>i(e.id,s),className:"inline-flex items-center gap-1 px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-xs",children:[r.jsx("span",{children:s}),r.jsx("span",{children:t})]},s)})}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("button",{onClick:()=>o(!l),className:"text-gray-400 hover:text-gray-600 text-sm mt-1",children:"React"}),l&&r.jsx("div",{className:"absolute bottom-full mb-2 bg-white border border-gray-200 rounded-lg shadow-lg p-2 flex gap-1 z-10",children:["\uD83D\uDC4D","❤️","\uD83D\uDE0A","\uD83D\uDE4F","\uD83D\uDCAA","\uD83E\uDD1D"].map(s=>r.jsx("button",{onClick:()=>{i(e.id,s),o(!1)},className:"text-lg hover:bg-gray-100 p-1 rounded",children:s},s))})]})]})})},l=({availableGroups:e,onJoinGroup:s,onClose:t,getGroupIcon:i})=>{let[n,l]=(0,a.useState)(""),[o,c]=(0,a.useState)("all"),u=e.filter(e=>{let s=e.name.toLowerCase().includes(n.toLowerCase())||e.description.toLowerCase().includes(n.toLowerCase()),t="all"===o||e.type===o;return s&&t});return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[80vh] overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-xl font-semibold",children:"Browse Support Groups"}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("div",{className:"mt-4 space-y-3",children:[r.jsx("input",{type:"text",value:n,onChange:e=>l(e.target.value),placeholder:"Search groups...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),r.jsx("select",{value:o,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[{value:"all",label:"All Groups"},{value:"language",label:"Language Groups"},{value:"country",label:"Country Groups"},{value:"interest",label:"Interest Groups"},{value:"support_topic",label:"Support Topics"}].map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]})]}),(0,r.jsxs)("div",{className:"p-6 overflow-y-auto max-h-96",children:[r.jsx("div",{className:"space-y-3",children:u.map(e=>r.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[r.jsx("span",{className:"text-2xl",children:i(e.type)}),(0,r.jsxs)("div",{className:"flex-1",children:[r.jsx("h3",{className:"font-medium",children:e.name}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,r.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:[e.members.length," members"]}),r.jsx("span",{className:"capitalize",children:e.type.replace("_"," ")}),e.settings.requireApproval&&r.jsx("span",{className:"text-yellow-600",children:"Requires approval"})]})]})]}),r.jsx("button",{onClick:()=>s(e.id),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Join"})]})},e.id))}),0===u.length&&r.jsx("div",{className:"text-center py-8 text-gray-500",children:"No groups found matching your criteria."})]})]})})},o=({userId:e,chatSystem:s,onClose:t})=>{let{t:o}=(0,i.useTranslation)("common"),[c,u]=(0,a.useState)(null),[d,m]=(0,a.useState)([]),[g,p]=(0,a.useState)([]),[h,x]=(0,a.useState)(null),[f,y]=(0,a.useState)([]),[b,v]=(0,a.useState)(""),[j,w]=(0,a.useState)(!1),[D,N]=(0,a.useState)(!1),[C,S]=(0,a.useState)([]),A=(0,a.useRef)(null),G=(0,a.useRef)(null),M=(0,a.useRef)([]);(0,a.useEffect)(()=>(_(),P(),()=>{O()}),[e]);let _=async()=>{try{let e=await E(),t=await s.registerUser(e);u(t),await F(),await L()}catch(e){console.error("Failed to initialize chat:",e)}},E=async()=>({displayName:`User${Math.floor(1e3*Math.random())}`,languagePreferences:["en"],interests:["mental_health","peer_support"],privacySettings:{showCountryOfOrigin:!1,showLanguages:!0,allowDirectMessages:!0,dataRetention:"standard"}}),P=()=>{s.on("message_sent",k),s.on("user_joined",I),s.on("user_left",R),s.on("reaction_added",U),s.on("notification",$)},O=()=>{s.removeAllListeners()},k=e=>{e.groupId===h&&(y(s=>[...s,e]),K())},I=({userId:e,groupId:s})=>{s===h&&T(s)},R=({userId:e,groupId:s})=>{s===h&&T(s)},U=({messageId:e,userId:s,emoji:t})=>{y(r=>r.map(r=>r.id===e?{...r,reactions:[...r.reactions.filter(e=>e.userId!==s),{emoji:t,userId:s,timestamp:new Date}]}:r))},$=e=>{S(s=>[...s,e]),setTimeout(()=>{S(s=>s.filter(s=>s!==e))},5e3)},F=async()=>{let e=[];p(e),e.length>0&&!h&&(x(e[0].id),await T(e[0].id))},L=async()=>{m([])},T=async t=>{try{let r=await s.getGroupMessages(t,e,50,0);y(r),K()}catch(e){console.error("Failed to load messages:",e)}},B=async()=>{if(b.trim()&&h)try{await s.sendMessage(e,h,b.trim()),v("")}catch(e){console.error("Failed to send message:",e)}},z=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),s=new MediaRecorder(e);G.current=s,M.current=[],s.ondataavailable=e=>{e.data.size>0&&M.current.push(e.data)},s.onstop=async()=>{let s=new Blob(M.current,{type:"audio/wav"});await H(s),e.getTracks().forEach(e=>e.stop())},s.start(),w(!0)}catch(e){console.error("Failed to start recording:",e)}},H=async t=>{if(!h)return;let r={audioUrl:URL.createObjectURL(t),duration:0,language:c?.languagePreferences[0]||"en"};try{await s.sendMessage(e,h,"","voice",r)}catch(e){console.error("Failed to send voice message:",e)}},J=async(t,r)=>{try{await s.addReaction(e,t,r)}catch(e){console.error("Failed to add reaction:",e)}},W=async t=>{try{await s.joinGroup(e,t)&&(await F(),x(t),await T(t),N(!1))}catch(e){console.error("Failed to join group:",e)}},q=async t=>{try{await s.leaveGroup(e,t)&&(await F(),h===t&&(x(g[0]?.id||null),g[0]&&await T(g[0].id)))}catch(e){console.error("Failed to leave group:",e)}},K=()=>{A.current?.scrollIntoView({behavior:"smooth"})},V=e=>new Intl.DateTimeFormat("en",{hour:"2-digit",minute:"2-digit"}).format(e),Y=e=>({language:"\uD83C\uDF10",country:"\uD83C\uDFE0",interest:"\uD83D\uDCAD",support_topic:"\uD83E\uDD1D",general:"\uD83D\uDCAC"})[e]||"\uD83D\uDCAC",Z=s=>"system"===s?"System":s===e?"You":`User${s.slice(-4)}`;return((0,a.useEffect)(()=>{K()},[f]),c)?(0,r.jsxs)("div",{className:"flex h-screen bg-gray-100",children:[(0,r.jsxs)("div",{className:"w-1/4 bg-white border-r border-gray-200 flex flex-col",children:[(0,r.jsxs)("div",{className:"p-4 border-b border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h2",{className:"text-lg font-semibold flex items-center gap-2",children:"\uD83D\uDCAC Peer Support Chat"}),t&&r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[r.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full"}),r.jsx("span",{children:c.displayName})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"My Groups"}),r.jsx("button",{onClick:()=>N(!0),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Browse"})]}),r.jsx("div",{className:"space-y-1",children:g.map(e=>r.jsx("button",{onClick:()=>{x(e.id),T(e.id)},className:`w-full text-left p-3 rounded-lg hover:bg-gray-50 transition-colors ${h===e.id?"bg-blue-50 border border-blue-200":""}`,children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("span",{className:"text-xl",children:Y(e.type)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[r.jsx("div",{className:"font-medium text-sm truncate",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 truncate",children:[e.members.length," members"]})]})]})},e.id))})]})}),(0,r.jsxs)("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx("span",{className:"text-lg",children:"\uD83C\uDFC6"}),r.jsx("span",{className:"text-sm font-medium",children:"Your Badges"})]}),r.jsx("div",{className:"flex flex-wrap gap-1",children:c.badges.map(e=>(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full",title:e.description,children:[r.jsx("span",{children:e.icon}),r.jsx("span",{children:e.name})]},e.id))}),(0,r.jsxs)("div",{className:"mt-2 text-xs text-gray-600",children:["Trust Score: ",c.trustScore,"/100"]})]})]}),r.jsx("div",{className:"flex-1 flex flex-col",children:h?(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"p-4 border-b border-gray-200 bg-white",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"font-medium flex items-center gap-2",children:[r.jsx("span",{children:Y(g.find(e=>e.id===h)?.type||"general")}),g.find(e=>e.id===h)?.name]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[g.find(e=>e.id===h)?.members.length," members"]})]}),r.jsx("div",{className:"flex items-center gap-2",children:r.jsx("button",{onClick:()=>q(h),className:"text-red-600 hover:text-red-800 text-sm px-3 py-1 border border-red-200 rounded-md hover:bg-red-50",children:"Leave Group"})})]})}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[f.map(s=>r.jsx(n,{message:s,isOwnMessage:s.senderId===e,getUserDisplayName:Z,onAddReaction:J,formatTime:V},s.id)),r.jsx("div",{ref:A})]}),r.jsx("div",{className:"p-4 border-t border-gray-200 bg-white",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex-1 relative",children:r.jsx("input",{type:"text",value:b,onChange:e=>v(e.target.value),onKeyPress:e=>"Enter"===e.key&&B(),placeholder:"Type your message...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),r.jsx("button",{onClick:j?()=>{G.current&&j&&(G.current.stop(),w(!1))}:z,className:`p-2 rounded-lg transition-colors ${j?"bg-red-600 text-white animate-pulse":"bg-gray-100 hover:bg-gray-200 text-gray-600"}`,children:"\uD83C\uDFA4"}),r.jsx("button",{onClick:B,disabled:!b.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:"Send"})]})})]}):r.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDCAC"}),r.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Welcome to Peer Support Chat"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"Select a group to start chatting with peers who understand your journey"}),r.jsx("button",{onClick:()=>N(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Browse Groups"})]})})}),D&&r.jsx(l,{availableGroups:d,onJoinGroup:W,onClose:()=>N(!1),getGroupIcon:Y}),r.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:C.map((e,s)=>r.jsx("div",{className:"bg-white border border-gray-200 rounded-lg shadow-lg p-3 max-w-sm",children:r.jsx("div",{className:"text-sm",children:e.data.message})},s))})]}):r.jsx("div",{className:"flex items-center justify-center h-64",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin text-4xl mb-4",children:"\uD83D\uDD04"}),r.jsx("p",{children:"Loading chat system..."})]})})}},4160:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});var r=t(7702);class a extends r.EventEmitter{constructor(){super(),this.users=new Map,this.groups=new Map,this.messages=new Map,this.userGroups=new Map,this.activeConnections=new Map,this.initializeDefaultGroups(),this.startCleanupScheduler()}async registerUser(e){let s={id:`user_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,anonymousId:`anonymous_${Math.random().toString(36).substr(2,12)}`,displayName:e.displayName||`User${Math.floor(1e3*Math.random())}`,avatar:e.avatar,languagePreferences:e.languagePreferences||["en"],countryOfOrigin:e.countryOfOrigin,interests:e.interests||[],trustScore:50,badges:[],joinedAt:new Date,lastActive:new Date,isOnline:!1,privacySettings:{showCountryOfOrigin:e.privacySettings?.showCountryOfOrigin??!1,showLanguages:e.privacySettings?.showLanguages??!0,allowDirectMessages:e.privacySettings?.allowDirectMessages??!0,dataRetention:e.privacySettings?.dataRetention||"standard"}};return this.users.set(s.id,s),this.userGroups.set(s.id,[]),await this.autoJoinGroups(s.id),this.emit("user_registered",s),s}async updateUserPreferences(e,s){let t=this.users.get(e);if(!t)throw Error("User not found");Object.assign(t,s),this.users.set(e,t),(s.languagePreferences||s.countryOfOrigin||s.interests)&&await this.autoJoinGroups(e)}async setUserOnlineStatus(e,s){let t=this.users.get(e);t&&(t.isOnline=s,t.lastActive=new Date,this.users.set(e,t),(this.userGroups.get(e)||[]).forEach(t=>{this.emit("user_status_changed",{userId:e,groupId:t,isOnline:s})}))}async createGroup(e,s){let t={id:`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:e.name||"New Group",description:e.description||"",type:e.type||"general",criteria:e.criteria||{},members:[s],moderators:[s],settings:{isPublic:!0,requireApproval:!1,allowVoiceMessages:!0,autoModeration:!0,retentionDays:30,notificationsEnabled:!0,...e.settings},createdAt:new Date,lastActivity:new Date,isActive:!0,maxMembers:e.maxMembers||50,rules:e.rules||this.getDefaultGroupRules()};this.groups.set(t.id,t),this.messages.set(t.id,[]);let r=this.userGroups.get(s)||[];return r.push(t.id),this.userGroups.set(s,r),this.emit("group_created",t),t}async joinGroup(e,s){let t=this.users.get(e),r=this.groups.get(s);if(!t||!r)return!1;if(r.members.includes(e))return!0;if(r.members.length>=r.maxMembers||!this.meetsGroupCriteria(t,r.criteria))return!1;r.members.push(e),r.lastActivity=new Date,this.groups.set(s,r);let a=this.userGroups.get(e)||[];return a.push(s),this.userGroups.set(e,a),await this.sendSystemMessage(s,`${t.displayName} joined the group`,"user_joined"),this.emit("user_joined",{userId:e,groupId:s}),!0}async leaveGroup(e,s){let t=this.users.get(e),r=this.groups.get(s);if(!t||!r)return!1;if(r.members=r.members.filter(s=>s!==e),r.moderators=r.moderators.filter(s=>s!==e),0===r.moderators.length&&r.members.length>0){let e=r.members.reduce((e,s)=>{let t=this.users.get(e),r=this.users.get(s);return(r?.trustScore||0)>(t?.trustScore||0)?s:e});r.moderators.push(e)}this.groups.set(s,r);let a=this.userGroups.get(e)||[];return this.userGroups.set(e,a.filter(e=>e!==s)),await this.sendSystemMessage(s,`${t.displayName} left the group`,"user_left"),this.emit("user_left",{userId:e,groupId:s}),!0}async sendMessage(e,s,t,r="text",a){let i=this.users.get(e),n=this.groups.get(s);if(!i||!n||!n.members.includes(e))return null;let l=await this.moderateContent(t,e),o={id:`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,groupId:s,senderId:e,content:l.approved?t:"[Message hidden by moderation]",type:r,voiceData:a,reactions:[],timestamp:new Date,isModerated:!l.approved,moderationFlag:l.flag,isEncrypted:!0,expiresAt:this.calculateMessageExpiration(n.settings.retentionDays)},c=this.messages.get(s)||[];return c.push(o),this.messages.set(s,c),n.lastActivity=new Date,this.groups.set(s,n),await this.checkAndAwardBadges(e),this.emit("message_sent",o),o}async addReaction(e,s,t){for(let[r,a]of this.messages){let i=a.find(e=>e.id===s);if(i){let a=this.groups.get(r);if(!a?.members.includes(e))return!1;return i.reactions=i.reactions.filter(s=>s.userId!==e),i.reactions.push({emoji:t,userId:e,timestamp:new Date}),this.emit("reaction_added",{messageId:s,userId:e,emoji:t}),!0}}return!1}async getGroupMessages(e,s,t=50,r=0){let a=this.groups.get(e);return a?.members.includes(s)?(this.messages.get(e)||[]).filter(e=>!e.expiresAt||e.expiresAt>new Date).slice(-t-r,-r||void 0).reverse():[]}async autoJoinGroups(e){let s=this.users.get(e);if(s)for(let[t,r]of this.groups)r.isActive&&r.settings.isPublic&&!r.members.includes(e)&&r.members.length<r.maxMembers&&this.meetsGroupCriteria(s,r.criteria)&&await this.joinGroup(e,t)}meetsGroupCriteria(e,s){return!(s.languages?.length&&!s.languages.some(s=>e.languagePreferences.includes(s))||s.countries?.length&&e.privacySettings.showCountryOfOrigin&&!s.countries.includes(e.countryOfOrigin||"")||s.interests?.length&&!s.interests.some(s=>e.interests.includes(s)))&&(!s.minTrustScore||!(e.trustScore<s.minTrustScore))}async moderateContent(e,s){let t=this.users.get(s);if(!t)return{approved:!1};for(let s of[/\b(hate|harm|violence|abuse)\b/i,/\b(spam|scam|fraud)\b/i])if(s.test(e))return{approved:!1,flag:{reason:"inappropriate",action:"hide",reviewedAt:new Date}};return t.trustScore<20?{approved:!1,flag:{reason:"harmful",action:"remove",reviewedAt:new Date}}:{approved:!0}}async checkAndAwardBadges(e){let s=this.users.get(e);if(!s)return;let t=await this.getUserMessageCount(e);this.userGroups.get(e)?.length,t>=10&&!s.badges.some(e=>"active_chatter"===e.id)&&s.badges.push({id:"active_chatter",name:"Active Chatter",description:"Sent 10 messages",icon:"\uD83D\uDCAC",earnedAt:new Date,type:"active"}),await this.getHelpfulReactionsCount(e)>=5&&!s.badges.some(e=>"helpful_friend"===e.id)&&(s.badges.push({id:"helpful_friend",name:"Helpful Friend",description:"Received 5 helpful reactions",icon:"\uD83E\uDD1D",earnedAt:new Date,type:"helper"}),s.trustScore=Math.min(100,s.trustScore+5)),this.users.set(e,s)}async getUserMessageCount(e){let s=0;for(let t of this.messages.values())s+=t.filter(s=>s.senderId===e).length;return s}async getHelpfulReactionsCount(e){let s=0,t=["\uD83D\uDC4D","❤️","\uD83D\uDE4F","\uD83D\uDCAA"];for(let r of this.messages.values())for(let a of r)a.senderId===e&&(s+=a.reactions.filter(e=>t.includes(e.emoji)).length);return s}async sendSystemMessage(e,s,t){let r={id:`sys_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,groupId:e,senderId:"system",content:s,type:"system",reactions:[],timestamp:new Date,isModerated:!1,isEncrypted:!1},a=this.messages.get(e)||[];a.push(r),this.messages.set(e,a)}calculateMessageExpiration(e){let s=new Date;return s.setDate(s.getDate()+e),s}startCleanupScheduler(){setInterval(()=>{this.cleanupExpiredMessages()},36e5)}cleanupExpiredMessages(){let e=new Date;for(let[s,t]of this.messages){let r=t.filter(s=>!s.expiresAt||s.expiresAt>e);this.messages.set(s,r)}}initializeDefaultGroups(){[{name:"English Support Circle",description:"General support in English",type:"language",criteria:{languages:["en"]}},{name:"华语互助圈 (Chinese Support)",description:"General support in Chinese",type:"language",criteria:{languages:["zh"]}},{name:"বাংলা সাহায্য (Bengali Support)",description:"General support in Bengali",type:"language",criteria:{languages:["bn"]}},{name:"New Arrivals Welcome",description:"Support for newcomers to Singapore",type:"support_topic",criteria:{interests:["newcomer_support"]}},{name:"Work Stress Support",description:"Dealing with workplace challenges",type:"support_topic",criteria:{interests:["work_stress"]}}].forEach(async e=>{await this.createGroup(e,"system")})}getDefaultGroupRules(){return["Be respectful and kind to all members","No personal attacks or harassment","Keep conversations supportive and constructive","Respect privacy - no sharing personal information","Use appropriate language for all ages","No spam or promotional content","Support each other's mental health journey"]}async sendNotification(e,s,t){this.users.get(e)&&this.emit("notification",{userId:e,type:s,data:t})}getGroupStats(e){let s=this.groups.get(e);if(!s)return null;let t=this.messages.get(e)||[],r=s.members.filter(e=>{let s=this.users.get(e);return s?.isOnline||!1}).length;return{memberCount:s.members.length,messageCount:t.length,activeMembers:r,lastActivity:s.lastActivity}}async exportUserData(e){let s=this.users.get(e);return s?{profile:s,groups:this.userGroups.get(e)||[],messageCount:await this.getUserMessageCount(e)}:null}async deleteUserData(e){if(!this.users.get(e))return!1;for(let s of this.userGroups.get(e)||[])await this.leaveGroup(e,s);for(let s of this.messages.values())s.forEach(s=>{s.senderId===e&&(s.senderId="anonymous",s.content="[Message from deleted user]")});return this.users.delete(e),this.userGroups.delete(e),!0}}let i=a},5545:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var r=t(997),a=t(1377);t(108);let i=(0,a.appWithTranslation)(function({Component:e,pageProps:s}){return r.jsx(e,{...s})})},9694:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var r=t(997),a=t(6859);function i(){return(0,r.jsxs)(a.Html,{children:[(0,r.jsxs)(a.Head,{children:[r.jsx("link",{rel:"manifest",href:"/manifest.json"}),r.jsx("meta",{name:"theme-color",content:"#000000"})]}),(0,r.jsxs)("body",{children:[r.jsx(a.Main,{}),r.jsx(a.NextScript,{})]})]})}},108:()=>{},5244:(e,s)=>{"use strict";var t;Object.defineProperty(s,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))}};