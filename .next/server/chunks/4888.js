"use strict";exports.id=4888,exports.ids=[4888],exports.modules={6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},4895:(e,t,a)=>{a.d(t,{_:()=>s});var n=a(3524);let s=global.prisma||new n.PrismaClient({log:["query","info","warn","error"]})},5384:(e,t,a)=>{a.d(t,{a:()=>c});var n=a(4895),s=a(7202),i=a.n(s);class r{constructor(){let e=process.env.TWILIO_ACCOUNT_SID,t=process.env.TWILIO_AUTH_TOKEN;this.fromNumber=process.env.TWILIO_WHATSAPP_NUMBER,this.client=i()(e,t)}async sendMessage(e,t){try{await this.client.messages.create({body:t,from:`whatsapp:${this.fromNumber}`,to:`whatsapp:${e}`})}catch(e){throw console.error("Error sending WhatsApp message:",e),e}}async sendQuickReplies(e,t,a){let n=`${t}

${a.map((e,t)=>`${t+1}. ${e}`).join("\n")}`;await this.sendMessage(e,n)}async sendInteractiveButtons(e,t,a){let n=`${t}

${a.map((e,t)=>`${t+1}. ${e.title}`).join("\n")}`;await this.sendMessage(e,n)}async sendMediaMessage(e,t,a){try{await this.client.messages.create({mediaUrl:[t],body:a,from:`whatsapp:${this.fromNumber}`,to:`whatsapp:${e}`})}catch(e){throw console.error("Error sending WhatsApp media:",e),e}}}class o{async processMessage(e,t){let a=e.toLowerCase().trim();if("help"===a||"menu"===a)return this.showMainMenu(t);if("stop"===a||"quit"===a)return this.handleStopCommand(t);switch(t.currentFlow){case"welcome":return this.handleWelcomeFlow(e,t);case"phq4_assessment":return this.handlePHQ4Flow(e,t);case"mood_checkin":return this.handleMoodCheckin(e,t);case"peer_support":return this.handlePeerSupport(e,t);case"resources":return this.handleResourcesFlow(e,t);default:return this.showMainMenu(t)}}showMainMenu(e){return{message:this.getLocalizedText("main_menu",e.language),quickReplies:[this.getLocalizedText("menu_assessment",e.language),this.getLocalizedText("menu_mood_log",e.language),this.getLocalizedText("menu_resources",e.language),this.getLocalizedText("menu_peer_support",e.language)],newState:{...e,currentFlow:"main_menu",step:0,context:{}}}}async handleWelcomeFlow(e,t){return 0===t.step?{message:this.getLocalizedText("welcome_message",t.language),quickReplies:[this.getLocalizedText("get_started",t.language),this.getLocalizedText("learn_more",t.language)],newState:{...t,step:1}}:e.toLowerCase().includes("start")||e.includes("开始")||e.includes("শুরু")?this.showMainMenu(t):this.showAppInfo(t)}async handlePHQ4Flow(e,t){if(0===t.step){let e=this.getLocalizedText("phq4_intro",t.language),a=this.getLocalizedText("phq4_q1_nervous",t.language);return{message:`${e}

1/4: ${a}`,quickReplies:["0 - Not at all","1 - Several days","2 - More than half","3 - Nearly every day"],newState:{...t,step:1,context:{answers:[]}}}}if(t.step<=4){let a=this.parseScore(e);if(-1===a)return{message:this.getLocalizedText("invalid_score",t.language),quickReplies:["0 - Not at all","1 - Several days","2 - More than half","3 - Nearly every day"],newState:t};if(t.context.answers.push(a),4===t.step)return await this.completePHQ4Assessment(t);{let e=this.getLocalizedText(["phq4_q1_nervous","phq4_q2_worry","phq4_q3_little_interest","phq4_q4_feeling_down"][t.step],t.language);return{message:`${t.step+1}/4: ${e}`,quickReplies:["0 - Not at all","1 - Several days","2 - More than half","3 - Nearly every day"],newState:{...t,step:t.step+1}}}}return this.showMainMenu(t)}async completePHQ4Assessment(e){let t=e.context.answers,a=t[0]+t[1],s=t[2]+t[3],i=a+s;await n._.pHQ4Assessment.create({data:{userId:e.userId,question1Score:t[2],question2Score:t[3],question3Score:t[0],question4Score:t[1],anxietyScore:a,depressionScore:s,totalScore:i,severityLevel:i>=9?"severe":i>=6?"moderate":i>=3?"mild":"minimal",language:e.language}}),await this.awardPoints(e.userId,"ASSESSMENT_COMPLETED",10);let r="phq4_result_minimal";if(i>=6){r="phq4_result_moderate";let t=await n._.mentalHealthResource.findFirst({where:{category:"counseling",isActive:!0}});t&&await n._.serviceReferral.create({data:{userId:e.userId,resourceId:t.id,referralType:"counseling",urgencyLevel:i>=9?"high":"medium",language:e.language}})}else i>=3&&(r="phq4_result_mild");return{message:this.getLocalizedText(r,e.language),buttons:[{id:"view_resources",title:this.getLocalizedText("view_resources",e.language)},{id:"main_menu",title:this.getLocalizedText("main_menu_button",e.language)}],newState:{...e,currentFlow:"main_menu",step:0,context:{}}}}async handleMoodCheckin(e,t){if(0===t.step)return{message:this.getLocalizedText("mood_checkin_prompt",t.language),quickReplies:["\uD83D\uDE14 1-2","\uD83D\uDE10 3-4","\uD83D\uDE42 5-6","\uD83D\uDE0A 7-8","\uD83D\uDE04 9-10"],newState:{...t,step:1}};if(1===t.step){let a=this.parseMoodLevel(e);return -1===a?{message:this.getLocalizedText("invalid_mood",t.language),quickReplies:["\uD83D\uDE14 1-2","\uD83D\uDE10 3-4","\uD83D\uDE42 5-6","\uD83D\uDE0A 7-8","\uD83D\uDE04 9-10"],newState:t}:(t.context.moodScore=a,{message:this.getLocalizedText("mood_notes_prompt",t.language),newState:{...t,step:2}})}return 2===t.step?(await n._.moodLog.create({data:{userId:t.userId,moodScore:t.context.moodScore,notes:"skip"===e?null:e,emotions:[],triggers:[],language:t.language}}),await this.awardPoints(t.userId,"MOOD_LOG_COMPLETED",5),{message:this.getLocalizedText("mood_logged_thanks",t.language),buttons:[{id:"view_trends",title:this.getLocalizedText("view_mood_trends",t.language)},{id:"main_menu",title:this.getLocalizedText("main_menu_button",t.language)}],newState:{...t,currentFlow:"main_menu",step:0,context:{}}}):this.showMainMenu(t)}async handleResourcesFlow(e,t){if(0===t.step)return{message:this.getLocalizedText("resources_menu",t.language),quickReplies:["crisis","counseling","support_group","self_help"].map(e=>this.getLocalizedText(`category_${e}`,t.language)),newState:{...t,step:1}};{let a=this.matchCategory(e,t.language);if(a){let e=await n._.mentalHealthResource.findMany({where:{category:a,isActive:!0},take:3}),s=this.getLocalizedText("resources_found",t.language)+"\n\n";return e.forEach((e,a)=>{let n=this.getResourceContent(e,t.language);s+=`${a+1}. ${n}

`}),{message:s,buttons:[{id:"more_resources",title:this.getLocalizedText("more_resources",t.language)},{id:"main_menu",title:this.getLocalizedText("main_menu_button",t.language)}],newState:{...t,currentFlow:"main_menu",step:0,context:{}}}}}return this.showMainMenu(t)}async handlePeerSupport(e,t){return{message:this.getLocalizedText("peer_support_coming_soon",t.language),buttons:[{id:"main_menu",title:this.getLocalizedText("main_menu_button",t.language)}],newState:{...t,currentFlow:"main_menu",step:0,context:{}}}}async handleSentimentResponse(e,t){let a="sentiment_neutral";return e.score<-.5?a="sentiment_negative":e.score>.5&&(a="sentiment_positive"),{message:this.getLocalizedText(a,t.language),buttons:[{id:"mood_checkin",title:this.getLocalizedText("log_mood",t.language)},{id:"view_resources",title:this.getLocalizedText("view_resources",t.language)}],newState:t}}parseScore(e){let t=e.match(/^[0-3]/)||e.match(/[0-3]/);return t?parseInt(t[0]):-1}parseMoodLevel(e){if(e.includes("1-2")||e.includes("\uD83D\uDE14"))return 2;if(e.includes("3-4")||e.includes("\uD83D\uDE10"))return 4;if(e.includes("5-6")||e.includes("\uD83D\uDE42"))return 6;if(e.includes("7-8")||e.includes("\uD83D\uDE0A"))return 8;if(e.includes("9-10")||e.includes("\uD83D\uDE04"))return 10;let t=parseInt(e);return t>=1&&t<=10?t:-1}async awardPoints(e,t,a){await n._.gamificationData.upsert({where:{userId:e},update:{totalPoints:{increment:a},updatedAt:new Date},create:{userId:e,totalPoints:a,level:1,streak:1}})}getLocalizedText(e,t){let a={main_menu:{en:"\uD83C\uDF1F Mental Wellness Assistant\n\nHow can I help you today?",zh:"\uD83C\uDF1F 心理健康助手\n\n我今天可以为您做些什么？",bn:"\uD83C\uDF1F মানসিক সুস্থতার সহায়ক\n\nআজ আমি আপনাকে কিভাবে সাহায্য করতে পারি?",ta:"\uD83C\uDF1F மன நல உதவியாளர்\n\nஇன்று நான் உங்களுக்கு எப்படி உதவ முடியும்?",my:"\uD83C\uDF1F စိတ်ကျန်းမာရေး အကူအညီ\n\nယနေ့ ကျွန်တော် သင့်ကို ဘယ်လို ကူညီနိုင်မလဲ?",id:"\uD83C\uDF1F Asisten Kesejahteraan Mental\n\nBagaimana saya bisa membantu Anda hari ini?"},welcome_message:{en:"\uD83D\uDC4B Welcome! I'm here to support your mental wellness journey. Everything is confidential and anonymous.",zh:"\uD83D\uDC4B 欢迎！我在这里支持您的心理健康之旅。一切都是保密和匿名的。",bn:"\uD83D\uDC4B স্বাগতম! আমি আপনার মানসিক সুস্থতার যাত্রায় সহায়তা করতে এখানে আছি। সবকিছু গোপনীয় এবং নামহীন।",ta:"\uD83D\uDC4B வரவேற்கிறோம்! உங்கள் மன நல பயணத்தை ஆதரிக்க நான் இங்கே இருக்கிறேன். எல்லாம் ரகசியமானது மற்றும் அநாமதேயமானது.",my:"\uD83D\uDC4B ကြိုဆိုပါတယ်! သင့်စိတ်ကျန်းမာရေး ခရီးကို ပံ့ပိုးဖို့ ကျွန်တော် ဒီမှာရှိပါတယ်။ အားလုံး လျှို့ဝှက်ပြီး အမည်မဖော်ပါ။",id:"\uD83D\uDC4B Selamat datang! Saya di sini untuk mendukung perjalanan kesejahteraan mental Anda. Semuanya rahasia dan anonim."},phq4_intro:{en:"\uD83D\uDCCB This is a brief mental health screening (PHQ-4). It takes 2 minutes and helps assess anxiety and depression levels.",zh:"\uD83D\uDCCB 这是一个简短的心理健康筛查(PHQ-4)。需要2分钟，有助于评估焦虑和抑郁水平。",bn:"\uD83D\uDCCB এটি একটি সংক্ষিপ্ত মানসিক স্বাস্থ্য স্ক্রিনিং (PHQ-4)। এটি 2 মিনিট সময় নেয় এবং উদ্বেগ ও বিষণ্নতার মাত্রা মূল্যায়ন করতে সাহায্য করে।",ta:"\uD83D\uDCCB இது ஒரு சுருக்கமான மன நல பரிசோதனை (PHQ-4). இது 2 நி்மிடங்கள் எடுக்கும் மற்றும் கவலை மற்றும் மனச்சோர்வு நிலைகளை மதிப்பிட உதவுகிறது.",my:"\uD83D\uDCCB ဒါက တိုတောင်းတဲ့ စိတ်ကျန်းမာရေး စစ်ဆေးမှု (PHQ-4) ပါ။ ၂ မိနစ်ခန့် ကြာပြီး စိုးရိမ်မှုနဲ့ စိတ်ဓာတ်ကျမှု အဆင့်များကို အကဲဖြတ်ဖို့ ကူညီပါတယ်။",id:"\uD83D\uDCCB Ini adalah skrining kesehatan mental singkat (PHQ-4). Membutuhkan 2 menit dan membantu menilai tingkat kecemasan dan depresi."},mood_checkin_prompt:{en:"\uD83D\uDE0A How are you feeling today? Please rate your mood from 1-10:",zh:"\uD83D\uDE0A 您今天感觉如何？请给您的心情打分1-10：",bn:"\uD83D\uDE0A আজ আপনার মন কেমন? অনুগ্রহ করে ১-১০ এর মধ্যে আপনার মেজাজ রেট করুন:",ta:"\uD83D\uDE0A இன்று நீங்கள் எப்படி உணர்கிறீர்கள்? தயவுசெய்து உங்கள் மனநிலையை 1-10 க்கு மதிப்பிடுங்கள்:",my:"\uD83D\uDE0A ယနေ့ သင် ဘယ်လို ခံစားနေပါသလဲ? သင့်စိတ်ခံစားမှုကို ၁-၁၀ အတွင်း အဆင့်သတ်မှတ်ပါ:",id:"\uD83D\uDE0A Bagaimana perasaan Anda hari ini? Silakan beri nilai suasana hati Anda dari 1-10:"}}[e];return a&&(a[t]||a.en)||e}showAppInfo(e){return{message:this.getLocalizedText("app_info",e.language),buttons:[{id:"get_started",title:this.getLocalizedText("get_started",e.language)}],newState:{...e,currentFlow:"main_menu",step:0}}}handleStopCommand(e){return{message:this.getLocalizedText("goodbye_message",e.language),newState:{...e,currentFlow:"stopped",step:0,context:{}}}}matchCategory(e,t){let a=e.toLowerCase();for(let[e,t]of Object.entries({crisis:["crisis","emergency","危机","সংকট","நெருக்கடி","အရေးပေါ်","krisis"],counseling:["counseling","therapy","咨询","পরামর্শ","ஆலோசனை","အကြံပေးခြင်း","konseling"],support_group:["group","support","小组","গ্রুপ","குழு","အုပ်စု","grup"],self_help:["self","help","自助","স্ব-সহায়তা","சுய உதவி","ကိုယ်တိုင်ကူညီ","bantuan diri"]}))if(t.some(e=>a.includes(e.toLowerCase())))return e;return"self_help"}getResourceContent(e,t){let a=e.title?.[t]||e.title?.en||"Resource",n=e.description?.[t]||e.description?.en||"";return`${a}
${n}`}}class u{async detect(e){let t=e.toLowerCase().trim();for(let[a,n]of Object.entries(this.languagePatterns))if(n.test(e)&&("en"!==a&&"id"!==a||this.commonWords[a].some(e=>t.includes(e))))return a;for(let[e,a]of Object.entries(this.commonWords))if(a.some(e=>t.includes(e)))return e;return"en"}getSupportedLanguages(){return Object.keys(this.languagePatterns)}constructor(){this.languagePatterns={en:/^[a-zA-Z\s.,!?'"()-]+$/,zh:/[\u4e00-\u9fff]/,bn:/[\u0980-\u09FF]/,ta:/[\u0B80-\u0BFF]/,my:/[\u1000-\u109F]/,id:/^[a-zA-Z\s.,!?'"()-]+$/},this.commonWords={en:["hello","hi","help","yes","no","thank","please","good","bad"],zh:["你好","帮助","是","不","谢谢","请","好","坏"],bn:["হ্যালো","সাহায্য","হ্যাঁ","না","ধন্যবাদ","অনুগ্রহ"],ta:["வணக்கம்","உதவி","ஆம்","இல்லை","நன்றி"],my:["မင်္ဂလာပါ","ကူညီ","ဟုတ်","မဟုတ်","ကျေးဇူး"],id:["halo","bantuan","ya","tidak","terima kasih","tolong"]}}}class l{async analyzeText(e){let t;let a=e.toLowerCase().split(/\s+/),n=0,s=0;a.forEach(e=>{this.positiveWords.includes(e)?n++:this.negativeWords.includes(e)&&s++});let i=a.length,r=Math.max(-1,Math.min(1,(n-s)/Math.max(i,1)*5));return t=r>.1?"positive":r<-.1?"negative":"neutral",{score:r,label:t,confidence:Math.abs(r)}}async analyzeVoice(e){try{return console.log(`Analyzing voice from: ${e}`),{score:0,label:"neutral",confidence:.5}}catch(e){return console.error("Error analyzing voice sentiment:",e),{score:0,label:"neutral",confidence:0}}}async analyzeMood(e,t){let a,n=(e-5.5)/4.5;t&&(n=.7*n+.3*(await this.analyzeText(t)).score);let s=Math.max(-1,Math.min(1,n));return a=s>.1?"positive":s<-.1?"negative":"neutral",{score:s,label:a,confidence:Math.abs(s)}}constructor(){this.positiveWords=["happy","good","great","excellent","wonderful","amazing","fantastic","joy","love","peace","calm","relaxed","grateful","thankful","blessed"],this.negativeWords=["sad","bad","terrible","awful","horrible","depressed","anxious","worried","scared","angry","frustrated","hopeless","worthless","lonely"]}}class c{constructor(){this.userStates=new Map,this.whatsapp=new r,this.conversation=new o,this.languageDetector=new u,this.sentimentAnalyzer=new l}async handleIncomingMessage(e){try{let t=await this.getOrCreateUser(e.from),a=this.getUserState(e.from);if(a||(a=await this.initializeUserState(t.id,e.from)),a.language&&"auto"!==a.language||(a.language=await this.languageDetector.detect(e.body),this.updateUserState(e.from,a)),e.mediaUrl&&"audio"===e.mediaType){await this.handleVoiceMessage(e,a);return}await this.processTextMessage(e,a),await this.logInteraction(t.id,e)}catch(t){console.error("Error handling WhatsApp message:",t),await this.sendErrorMessage(e.from)}}async getOrCreateUser(e){let t=this.hashPhone(e),a=await n._.anonymousUser.findFirst({where:{deviceFingerprint:t}});return a||(a=await n._.anonymousUser.create({data:{anonymousId:`wa_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,language:"auto",deviceFingerprint:t,isActive:!0}})),a}async initializeUserState(e,t){let a={userId:e,language:"auto",currentFlow:"welcome",step:0,context:{},lastActivity:new Date};return this.userStates.set(t,a),a}getUserState(e){return this.userStates.get(e)}updateUserState(e,t){t.lastActivity=new Date,this.userStates.set(e,t)}async processTextMessage(e,t){if(await this.detectCrisisMessage(e.body,t.language)){await this.handleCrisisIntervention(e.from,t);return}let a=await this.conversation.processMessage(e.body,t);await this.sendResponse(e.from,a,t.language),this.updateUserState(e.from,a.newState)}async handleVoiceMessage(e,t){try{let a=await this.sentimentAnalyzer.analyzeVoice(e.mediaUrl);await n._.moodLog.create({data:{userId:t.userId,moodScore:this.sentimentToMoodLevel(a.score),notes:"Voice message sentiment analysis",sentimentScore:a.score,sentimentLabel:a.label}});let s=await this.conversation.handleSentimentResponse(a,t);await this.sendResponse(e.from,s,t.language)}catch(a){console.error("Error processing voice message:",a),await this.sendMessage(e.from,this.getLocalizedText("voice_processing_error",t.language))}}async detectCrisisMessage(e,t){let a={en:["suicide","kill myself","end it all","worthless","hopeless"],zh:["自杀","死","结束生命","没有希望"],bn:["আত্মহত্যা","মৃত্যু","জীবন শেষ"],ta:["தற்கொலை","இறப்பு","வாழ்க்கை முடிவு"],my:["သေ","အသက်ဆုံး","မျှော်လင့်ချက်မရှိ"],id:["bunuh diri","mati","mengakhiri hidup"]},n=a[t]||a.en,s=e.toLowerCase();return n.some(e=>s.includes(e.toLowerCase()))}async handleCrisisIntervention(e,t){let a=this.getLocalizedText("crisis_intervention",t.language);await this.sendMessage(e,a);let s=await n._.mentalHealthResource.findFirst({where:{category:"crisis",isActive:!0}});if(s)await n._.serviceReferral.create({data:{userId:t.userId,resourceId:s.id,referralType:"emergency",urgencyLevel:"high",language:t.language}});else{console.warn(`No crisis resources available for user ${t.userId}`);let e=await n._.mentalHealthResource.create({data:{title:{en:"Emergency Crisis Support",zh:"紧急危机支持",bn:"জরুরী সংকট সহায়তা",ta:"அவசர நெருக்கடி ஆதரவு",my:"အရေးပေါ် အကြပ်အတည်း အကူအညီ",id:"Dukungan Krisis Darurat"},description:{en:"If you are in immediate danger, please contact emergency services (911/999) or go to your nearest emergency room.",zh:"如果您处于紧急危险中，请联系紧急服务(911/999)或前往最近的急诊室。",bn:"আপনি যদি তাৎক্ষণিক বিপদে থাকেন, অনুগ্রহ করে জরুরি সেবায় (911/999) যোগাযোগ করুন বা আপনার নিকটতম জরুরি কক্ষে যান।",ta:"நீங்கள் உடனடி ஆபத்தில் இருந்தால், தயவுசெய்து அவசர சேவைகளை (911/999) தொடர்பு கொள்ளுங்கள் அல்லது உங்கள் அருகிலுள்ள அவசர அறைக்குச் செல்லுங்கள்।",my:"သင်သည် ချက်ခြင်းအန္တရာယ်ကြုံနေလျှင် အရေးပေါ်ဝန်ဆောင်မှုများ (911/999) ကို ဆက်သွယ်ပါ သို့မဟုတ် အနီးဆုံးအရေးပေါ်ခန်းသို့သွားပါ။",id:"Jika Anda dalam bahaya langsung, silakan hubungi layanan darurat (911/999) atau pergi ke ruang gawat darurat terdekat."},category:"crisis",resourceType:"hotline",contactInfo:{phone:"911",description:"Emergency Services"},availability:{hours:"24/7",languages:["en","zh","bn","ta","my","id"]},targetAudience:["general","migrant_workers"],languages:["en","zh","bn","ta","my","id"],isFree:!0,isEmergency:!0,isActive:!0,priority:1}});await n._.serviceReferral.create({data:{userId:t.userId,resourceId:e.id,referralType:"emergency",urgencyLevel:"high",language:t.language}})}let i=await n._.mentalHealthResource.findMany({where:{category:"crisis",isActive:!0},orderBy:{priority:"asc"},take:5});if(i.length>0)for(let a of i){let n=this.getResourceText(a,t.language);await this.sendMessage(e,n),await new Promise(e=>setTimeout(e,500))}else{let a=this.getLocalizedText("crisis_fallback_resources",t.language);await this.sendMessage(e,a)}}async sendProactiveNudge(e,t,a){try{let s=await n._.anonymousUser.findUnique({where:{id:e}});if(!s||!s.isActive)return;let i=this.getUserState(t)||await this.initializeUserState(e,t),r="";switch(a){case"daily_checkin":r=this.getLocalizedText("daily_checkin_nudge",i.language);break;case"mood_log":r=this.getLocalizedText("mood_log_reminder",i.language);break;case"assessment_reminder":r=this.getLocalizedText("assessment_reminder",i.language);break;case"wellness_tip":r=await this.getRandomWellnessTip(i.language)}await this.sendMessage(t,r),await n._.userInteraction.create({data:{userId:e,interactionType:"PROACTIVE_NUDGE",entityType:"nudge",entityId:a,metadata:{nudgeType:a}}})}catch(e){console.error("Error sending proactive nudge:",e)}}async sendResponse(e,t,a){t.quickReplies&&t.quickReplies.length>0?await this.sendQuickReplies(e,t.message,t.quickReplies):t.buttons&&t.buttons.length>0?await this.sendInteractiveButtons(e,t.message,t.buttons):await this.sendMessage(e,t.message)}async sendMessage(e,t){await this.whatsapp.sendMessage(e,t)}async sendQuickReplies(e,t,a){await this.whatsapp.sendQuickReplies(e,t,a)}async sendInteractiveButtons(e,t,a){await this.whatsapp.sendInteractiveButtons(e,t,a)}async sendErrorMessage(e){let t=this.getUserState(e),a=t?.language||"en",n=this.getLocalizedText("error_message",a);await this.sendMessage(e,n)}async logInteraction(e,t){await n._.userInteraction.create({data:{userId:e,interactionType:"WHATSAPP_MESSAGE",entityType:"message",entityId:t.from,metadata:{mediaType:t.mediaType,mediaUrl:t.mediaUrl,timestamp:t.timestamp}}})}hashPhone(e){return a(4770).createHash("sha256").update(e+process.env.PHONE_SALT).digest("hex")}sentimentToMoodLevel(e){return Math.round((e+1)/2*9+1)}getLocalizedText(e,t){let a={crisis_intervention:{en:"\uD83D\uDEA8 I'm concerned about you. Please reach out to a crisis helpline immediately. You're not alone, and help is available 24/7.",zh:"\uD83D\uDEA8 我很担心你。请立即联系危机求助热线。你并不孤单，24/7都有帮助可用。",bn:"\uD83D\uDEA8 আমি আপনার জন্য চিন্তিত। অনুগ্রহ করে অবিলম্বে একটি সংকট হেল্পলাইনে যোগাযোগ করুন।",ta:"\uD83D\uDEA8 நான் உங்களைப் பற்றி கவலைப்படுகிறேன். உடனடியாக நெருக்கடி உதவி எண்ணை தொடர்பு கொள்ளுங்கள்।",my:"\uD83D\uDEA8 ကျွန်တော် သင့်အတွက် စိုးရိမ်နေပါသည်။ ချက်ချင်း အရေးပေါ် ကူညီရေး ဖုန်းနံပါတ်ကို ဆက်သွယ်ပါ။",id:"\uD83D\uDEA8 Saya khawatir tentang Anda. Silakan hubungi hotline krisis segera. Anda tidak sendirian."},crisis_fallback_resources:{en:"\uD83C\uDD98 Emergency Contacts:\n• Emergency Services: 911\n• Crisis Text Line: Text HOME to 741741\n• National Suicide Prevention Lifeline: 988\n\nYou are not alone. Help is available.",zh:"\uD83C\uDD98 紧急联系方式:\n• 紧急服务: 911\n• 危机短信热线: 发送HOME到741741\n• 全国自杀预防生命线: 988\n\n你并不孤单。帮助随时可用。",bn:"\uD83C\uDD98 জরুরি যোগাযোগ:\n• জরুরি সেবা: ৯৯৯\n• সংকট টেক্সট লাইন: HOME লিখে 741741 এ পাঠান\n\nআপনি একা নন। সাহায্য উপলব্ধ।",ta:"\uD83C\uDD98 அவசர தொடர்புகள்:\n• அவசர சேவைகள்: 108\n• நெருக்கடி உரை வரி: HOME என்று 741741 க்கு அனுப்பவும்\n\nநீங்கள் தனியாக இல்லை। உதவி கிடைக்கிறது।",my:"\uD83C\uDD98 အရေးပေါ်ဆက်သွယ်ရန်:\n• အရေးပေါ်ဝန်ဆောင်မှုများ: 911\n• အကြပ်အတည်းစာသားလိုင်း: HOME ကို 741741 သို့ပို့ပါ\n\nသင်မှာတစ်ယောက်တည်းမဟုတ်ပါ။ အကူအညီရရှိနိုင်ပါသည်။",id:"\uD83C\uDD98 Kontak Darurat:\n• Layanan Darurat: 112\n• Hotline Krisis: 119 ext 8\n• Sejiwa: 119 ext 8\n\nAnda tidak sendirian. Bantuan tersedia."},daily_checkin_nudge:{en:"\uD83C\uDF1F How are you feeling today? Take a moment to check in with yourself.",zh:"\uD83C\uDF1F 你今天感觉怎么样？花一点时间关注一下自己。",bn:"\uD83C\uDF1F আজ আপনার মনের অবস্থা কেমন? নিজের সাথে একটু সময় কাটান।",ta:"\uD83C\uDF1F இன்று நீங்கள் எப்படி உணர்கிறீர்கள்? உங்களுடன் சிறிது நேரம் செலவிடுங்கள்।",my:"\uD83C\uDF1F ယနေ့ သင် ဘယ်လို ခံစားနေပါသလဲ။ သင့်ကိုယ်သင် ဂရုစိုက်ကြည့်ပါ။",id:"\uD83C\uDF1F Bagaimana perasaan Anda hari ini? Luangkan waktu sejenak untuk memeriksa diri sendiri."},mood_log_reminder:{en:"\uD83D\uDCDD Don't forget to log your mood today! It helps track your emotional wellbeing.",zh:"\uD83D\uDCDD 别忘了今天记录你的心情！这有助于跟踪你的情绪健康。",bn:"\uD83D\uDCDD আজ আপনার মেজাজ লগ করতে ভুলবেন না! এটি আপনার আবেগময় সুস্থতা ট্র্যাক করতে সাহায্য করে।",ta:"\uD83D\uDCDD இன்று உங்கள் மனநிலையைப் பதிவு செய்ய மறக்காதீர்கள்! இது உங்கள் உணர்ச்சி நல்வாழ்வைக் கண்காணிக்க உதவுகிறது।",my:"\uD83D\uDCDD ဒီနေ့ သင့်စိတ်ခံစားမှုကို မှတ်တမ်းတင်ဖို့ မမေ့နဲ့! ဒါက သင့်စိတ်ပိုင်းဆိုင်ရာ ကျန်းမာရေးကို ကောင်းကောင်းကြည့်ဖို့ ကူညီပါတယ်။",id:"\uD83D\uDCDD Jangan lupa catat suasana hati Anda hari ini! Ini membantu melacak kesejahteraan emosional Anda."},assessment_reminder:{en:"\uD83D\uDD0D Time for a quick mental health check-in. Complete a brief assessment to understand your wellbeing.",zh:"\uD83D\uDD0D 是时候进行快速心理健康检查了。完成简短评估以了解您的健康状况。",bn:"\uD83D\uDD0D দ্রুত মানসিক স্বাস্থ্য চেক-ইনের সময়। আপনার সুস্থতা বোঝার জন্য একটি সংক্ষিপ্ত মূল্যায়ন সম্পূর্ণ করুন।",ta:"\uD83D\uDD0D விரைவான மனநல பரிசோதனையின் நேரம். உங்கள் நல்வாழ்வைப் புரிந்துகொள்ள ஒரு சுருக்கமான மதிப்பீட்டை முடிக்கவும்।",my:"\uD83D\uDD0D စိတ်ကျန်းမာရေး အမြန်စစ်ဆေးချိန်ရောက်ပြီ။ သင့်ကျန်းမာရေးအခြေအနေကို နားလည်ဖို့ တိုတောင်းတဲ့ အကဲဖြတ်မှုတစ်ခု လုပ်ပါ။",id:"\uD83D\uDD0D Saatnya pemeriksaan kesehatan mental singkat. Selesaikan penilaian singkat untuk memahami kesejahteraan Anda."},error_message:{en:"Sorry, I couldn't understand that. Please try again or type 'help' for assistance.",zh:"抱歉，我无法理解。请重试或输入'帮助'寻求协助。",bn:"দুঃখিত, আমি বুঝতে পারিনি। অনুগ্রহ করে আবার চেষ্টা করুন বা 'সাহায্য' টাইপ করুন।",ta:"மன்னிக்கவும், எனக்கு புரியவில்லை. மீண்டும் முயற்சிக்கவும் அல்லது 'உதவி' என்று தட்டச்சு செய்யவும்।",my:"စိတ်မကောင်းပါဘူး၊ နားမလည်ပါ။ ထပ်ကြိုးစားပါ သို့မဟုတ် 'အကူအညီ' ဟုရိုက်ပါ။",id:"Maaf, saya tidak mengerti. Silakan coba lagi atau ketik 'bantuan' untuk mendapat bantuan."},voice_processing_error:{en:"I had trouble processing your voice message. Please try sending a text message instead.",zh:"我无法处理您的语音消息。请尝试发送文本消息。",bn:"আপনার ভয়েস বার্তা প্রক্রিয়া করতে সমস্যা হয়েছে। পরিবর্তে টেক্সট বার্তা পাঠানোর চেষ্টা করুন।",ta:"உங்கள் குரல் செய்தியை செயலாக்குவதில் சிக்கல் உள்ளது. பதிலாக உரை செய்தி அனுப்ப முயற்சிக்கவும்।",my:"သင့်အသံစာကို လုပ်ဆောင်ရာတွင် ပြဿနာရှိပါသည်။ စာတစ်စောင် ပို့ကြည့်ပါ။",id:"Saya mengalami masalah memproses pesan suara Anda. Silakan coba kirim pesan teks."},default_wellness_tip:{en:"\uD83D\uDCA1 Wellness Tip: Take 5 deep breaths and remind yourself that you are enough, just as you are.",zh:"\uD83D\uDCA1 健康小贴士：深呼吸5次，提醒自己你就是你，这样就足够了。",bn:"\uD83D\uDCA1 সুস্থতার টিপ: ৫টি গভীর শ্বাস নিন এবং নিজেকে মনে করিয়ে দিন যে আপনি যথেষ্ট, ঠিক যেমন আছেন।",ta:"\uD83D\uDCA1 நல்வாழ்வு குறிப்பு: 5 ஆழமான மூச்சுகளை எடுத்து, நீங்கள் இருக்கும் விதத்திலேயே போதும் என்று உங்களுக்கு நினைவூட்டுங்கள்।",my:"\uD83D\uDCA1 ကျန်းမာရေးအကြံပြုချက်: နက်ရှိုင်းစွာ အသက်ရှူ ၅ကြိမ်ရှူပြီး သင်သည် လုံလောက်သည်ဟု သင့်ကိုယ်သင် သတိပေးပါ။",id:"\uD83D\uDCA1 Tips Kesehatan: Ambil 5 napas dalam dan ingatkan diri Anda bahwa Anda sudah cukup, apa adanya."}}[e];return a?a[t]||a.en:e}getResourceText(e,t){let a=e.title?.[t]||e.title?.en||"Resource",n=e.description?.[t]||e.description?.en||"",s="";if(e.contactInfo&&"object"==typeof e.contactInfo){let t=e.contactInfo.phone,a=e.contactInfo.description;t&&(s+=`
📞 ${a||"Contact"}: ${t}`)}let i="";return e.availability?.hours&&(i=`
🕒 Available: ${e.availability.hours}`),`📋 ${a}
${n}${s}${i}`}async getRandomWellnessTip(e){let t=await n._.mentalHealthResource.findMany({where:{category:"self_help",resourceType:"document",isActive:!0}});if(0===t.length)return this.getLocalizedText("default_wellness_tip",e);let a=t[Math.floor(Math.random()*t.length)];return this.getResourceText(a,e)}}},7153:(e,t)=>{var a;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))},1802:(e,t,a)=>{e.exports=a(145)}};