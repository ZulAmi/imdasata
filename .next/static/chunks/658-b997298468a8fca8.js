"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[658],{5658:function(e,t,s){s.d(t,{Lz:function(){return n},VJ:function(){return r}});var i=s(185);class a{static getSessionId(e){return this.activeSessions.get(e)}static trackPageView(e,t,s){let a=this.getSessionId(t);a&&i.G.trackPageView(a,{pagePath:e,pageTitle:e,timestamp:new Date,...s})}static trackUserInteraction(e,t,s,a){let n=this.getSessionId(e);n&&i.G.trackInteraction(n,{type:"click",element:t,elementType:s,page:t,timestamp:new Date,metadata:a})}static startSession(e,t){let s=i.G.startSession(e,{device:(null==t?void 0:t.device)||"desktop",browser:(null==t?void 0:t.browser)||"unknown",platform:(null==t?void 0:t.platform)||"web",userAgent:(null==t?void 0:t.userAgent)||navigator.userAgent,isActive:!0});return this.activeSessions.set(e,s),s}static endSession(e){let t=this.getSessionId(e);t&&(i.G.endSession(t),this.activeSessions.delete(e))}static trackDailyCheckIn(e,t,s,a){this.trackUserInteraction(e,"daily-checkin","completed",{mood:t,energy:s,anxiety:a,timestamp:Date.now()}),i.G.trackFeatureUsage(e,{feature:"daily-checkin",action:"completed",timestamp:new Date,duration:120,success:!0})}static trackMoodAssessment(e,t,s,a){i.G.trackAssessmentCompletion(e,t,a?"completed":"abandoned"),a&&this.trackUserInteraction(e,"mood-assessment","completed",{assessmentType:t,score:s})}static trackContentEngagement(e,t,s,a,n){i.G.trackContentInteraction(e,{contentId:s,contentType:t,category:"education",action:a,timestamp:new Date,duration:n}),"view"===a?this.trackUserInteraction(e,"education","content-viewed",{contentType:t,contentId:s}):"complete"===a&&this.trackUserInteraction(e,"education","content-completed",{contentType:t,contentId:s,duration:n})}static trackPeerSupportActivity(e,t,s){this.trackUserInteraction(e,"peer-support",t,s)}static trackCrisisResourceAccess(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.trackUserInteraction(e,"crisis-resources","accessed",{resourceType:t,urgent:s,timestamp:Date.now()}),i.G.trackFeatureUsage(e,{feature:"crisis-resources",action:"accessed",timestamp:new Date,duration:60,success:!0})}static trackBuddyActivity(e,t,s,i){this.trackUserInteraction(e,"buddy-system",t,{buddyId:s,...i,timestamp:Date.now()}),("message"===t||"support"===t)&&this.trackPeerSupportActivity(e,"message"===t?"message-sent":"support-given",{buddyId:s,context:"buddy-system"})}static trackGamificationActivity(e,t,s,a){this.trackUserInteraction(e,"gamification",t,{points:s,...a,timestamp:Date.now()}),i.G.trackFeatureUsage(e,{feature:"gamification",action:t,timestamp:new Date,duration:30,success:!0})}static trackNotificationActivity(e,t,s,a){"sent"===s?i.G.trackNotificationSent({userId:e,notificationId:t,type:a}):"opened"===s?i.G.trackNotificationOpened(e,t):"clicked"===s&&(i.G.trackNotificationClicked(e,t),this.trackUserInteraction(e,"notifications","clicked",{notificationId:t,notificationType:a}))}static async getUserEngagementInsights(e){return{score:10*Math.random(),level:"High",recommendations:["Continue daily check-ins","Explore new content"]}}static async getPlatformAnalytics(){return i.G.getAnalyticsDashboard()}static initializeUserSession(e,t){this.startSession(e,t),this.trackPageView("dashboard",e,{sessionStart:!0,deviceInfo:t})}static cleanupUserSession(e){this.endSession(e),this.trackUserInteraction(e,"authentication","logged-out",{timestamp:Date.now()})}}a.activeSessions=new Map;let n=a,r=e=>({trackInteraction:(t,s,i)=>{a.trackUserInteraction(e,t,s,i)},trackPageView:(t,s)=>{a.trackPageView(t,e,s)},trackFeatureUsage:function(t,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"completed";i.G.trackFeatureUsage(e,{feature:t,action:a,timestamp:new Date,duration:s,success:!0})},trackDailyCheckIn:(t,s,i)=>a.trackDailyCheckIn(e,t,s,i),trackContentEngagement:(t,s,i,n)=>a.trackContentEngagement(e,t,s,i,n),trackPeerSupport:(t,s)=>a.trackPeerSupportActivity(e,t,s),trackGamification:(t,s,i)=>a.trackGamificationActivity(e,t,s,i)})},185:function(e,t,s){s.d(t,{G:function(){return n}});var i=s(7187);class a extends i.EventEmitter{startSession(e,t){let s="session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),i={userId:e,sessionId:s,startTime:new Date,device:t.device||"desktop",browser:t.browser||"unknown",platform:t.platform||"web",userAgent:t.userAgent||"",pageViews:[],interactions:[],isActive:!0,...t};return this.sessions.set(s,i),this.emit("sessionStarted",i),s}endSession(e){let t=this.sessions.get(e);t&&(t.endTime=new Date,t.duration=Math.floor((t.endTime.getTime()-t.startTime.getTime())/1e3),t.isActive=!1,this.sessions.set(e,t),this.emit("sessionEnded",t),this.updateEngagementScore(t.userId))}trackPageView(e,t){let s=this.sessions.get(e);if(!s)return;let i={pageId:"page_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,6)),pagePath:t.pagePath||"",pageTitle:t.pageTitle||"",timestamp:new Date,exitPage:!1,...t};if(s.pageViews.length>0){let e=s.pageViews[s.pageViews.length-1];e.exitPage=!1,e.timeOnPage=Math.floor((i.timestamp.getTime()-e.timestamp.getTime())/1e3)}s.pageViews.push(i),this.sessions.set(e,s),this.emit("pageViewed",{session:s,pageView:i})}trackInteraction(e,t){let s=this.sessions.get(e);if(!s)return;let i={id:"interaction_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,6)),userId:s.userId,sessionId:e,type:t.type||"click",element:t.element||"",elementType:t.elementType||"",page:t.page||"",timestamp:new Date,...t};s.interactions.push(i);let a=this.userInteractions.get(s.userId)||[];a.push(i),this.userInteractions.set(s.userId,a),this.emit("interactionTracked",i)}trackFeatureUsage(e,t){let s={userId:e,feature:t.feature||"",action:t.action||"",timestamp:new Date,success:!1!==t.success,...t},i=this.featureUsage.get(e)||[];i.push(s),this.featureUsage.set(e,i),this.emit("featureUsed",s)}trackContentInteraction(e,t){let s={userId:e,contentId:t.contentId||"",contentType:t.contentType||"article",category:t.category||"",action:t.action||"view",timestamp:new Date,...t},i=this.contentInteractions.get(e)||[];i.push(s),this.contentInteractions.set(e,i),this.emit("contentInteracted",s)}trackAssessmentStart(e,t){let s={userId:e,assessmentId:t.assessmentId||"",assessmentType:t.assessmentType||"custom",startTime:new Date,isCompleted:!1,...t},i=this.assessmentTracking.get(e)||[];i.push(s),this.assessmentTracking.set(e,i),this.emit("assessmentStarted",s)}trackAssessmentCompletion(e,t,s){let i=this.assessmentTracking.get(e)||[],a=i.find(e=>e.assessmentId===t);if(a){a.completionTime=new Date,a.duration=Math.floor((a.completionTime.getTime()-a.startTime.getTime())/1e3),a.isCompleted=!0,a.score=s.score,a.responses=s.responses;let n=i.filter(e=>e.assessmentType===a.assessmentType&&e.isCompleted&&e.assessmentId!==t).sort((e,t)=>t.completionTime.getTime()-e.completionTime.getTime());n.length>0&&(a.previousScore=n[0].score,a.score&&a.previousScore&&(a.score<a.previousScore?a.improvementTrend="improving":a.score>a.previousScore?a.improvementTrend="declining":a.improvementTrend="stable")),this.assessmentTracking.set(e,i),this.emit("assessmentCompleted",a)}}trackPeerSupportActivity(e,t){let s={userId:e,activityType:t.activityType||"message-sent",timestamp:new Date,...t},i=this.peerSupportMetrics.get(e)||[];i.push(s),this.peerSupportMetrics.set(e,i),this.emit("peerSupportActivity",s)}trackNotificationSent(e){let t={notificationId:e.notificationId||"notif_".concat(Date.now()),userId:e.userId||"",type:e.type||"push",category:e.category||"reminder",title:e.title||"",message:e.message||"",sentAt:new Date,isOpened:!1,isClicked:!1,deliveryStatus:"sent",...e},s=this.notificationMetrics.get(t.userId)||[];s.push(t),this.notificationMetrics.set(t.userId,s),this.emit("notificationSent",t)}trackNotificationDelivered(e,t){let s=this.notificationMetrics.get(t)||[],i=s.find(t=>t.notificationId===e);i&&(i.deliveredAt=new Date,i.deliveryStatus="delivered",this.notificationMetrics.set(t,s),this.emit("notificationDelivered",i))}trackNotificationOpened(e,t){let s=this.notificationMetrics.get(t)||[],i=s.find(t=>t.notificationId===e);i&&(i.openedAt=new Date,i.isOpened=!0,this.notificationMetrics.set(t,s),this.emit("notificationOpened",i))}trackNotificationClicked(e,t,s){let i=this.notificationMetrics.get(t)||[],a=i.find(t=>t.notificationId===e);a&&(a.clickedAt=new Date,a.isClicked=!0,a.actionTaken=s,this.notificationMetrics.set(t,i),this.emit("notificationClicked",a))}getDailyActiveUsers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=new Date(e);t.setHours(0,0,0,0);let s=new Date(e);s.setHours(23,59,59,999);let i=new Set;for(let e of this.sessions.values())e.startTime>=t&&e.startTime<=s&&i.add(e.userId);return i.size}getWeeklyActiveUsers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=new Date(e);t.setDate(e.getDate()-e.getDay()),t.setHours(0,0,0,0);let s=new Date(t);s.setDate(t.getDate()+6),s.setHours(23,59,59,999);let i=new Set;for(let e of this.sessions.values())e.startTime>=t&&e.startTime<=s&&i.add(e.userId);return i.size}getMonthlyActiveUsers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=new Date(e.getFullYear(),e.getMonth(),1),s=new Date(e.getFullYear(),e.getMonth()+1,0,23,59,59,999),i=new Set;for(let e of this.sessions.values())e.startTime>=t&&e.startTime<=s&&i.add(e.userId);return i.size}getFeatureUsagePatterns(){let e=new Map;for(let[t,s]of this.featureUsage)for(let t of s){let s=t.feature;e.has(s)||e.set(s,{feature:s,totalUsers:0,activeUsers:{daily:0,weekly:0,monthly:0},usageFrequency:{daily:0,weekly:0,monthly:0,rarely:0},averageSessionDuration:0,completionRate:0,satisfactionScore:0,topUserActions:[],dropoffPoints:[]});let i=e.get(s);i.totalUsers++}return e}getContentInteractionRates(){let e={};for(let[t,s]of this.contentInteractions)for(let t of s){let s=t.contentType;e[s]||(e[s]={totalViews:0,totalCompletions:0,averageDuration:0,averageProgress:0,topCategories:new Map});let i=e[s];"view"===t.action&&i.totalViews++,"complete"===t.action&&i.totalCompletions++,t.duration&&(i.averageDuration=(i.averageDuration+t.duration)/2),t.progress&&(i.averageProgress=(i.averageProgress+t.progress)/2);let a=i.topCategories.get(t.category)||0;i.topCategories.set(t.category,a+1)}return e}getAssessmentCompletionRates(){let e={};for(let[t,s]of this.assessmentTracking)for(let t of s){let s=t.assessmentType;e[s]||(e[s]={totalStarted:0,totalCompleted:0,completionRate:0,averageDuration:0,improvementRate:0});let i=e[s];i.totalStarted++,t.isCompleted&&(i.totalCompleted++,t.duration&&(i.averageDuration=(i.averageDuration+t.duration)/2),"improving"===t.improvementTrend&&i.improvementRate++),i.completionRate=i.totalCompleted/i.totalStarted*100}return e}getPeerSupportParticipation(){let e={totalParticipants:this.peerSupportMetrics.size,messagesSent:0,supportGiven:0,groupJoins:0,averageResponseTime:0,sentimentDistribution:{positive:0,neutral:0,negative:0,supportive:0}},t=0,s=0;for(let[i,a]of this.peerSupportMetrics)for(let i of a){switch(i.activityType){case"message-sent":e.messagesSent++;break;case"support-given":e.supportGiven++;break;case"group-join":e.groupJoins++}i.responseTime&&(t+=i.responseTime,s++),i.sentiment&&e.sentimentDistribution[i.sentiment]++}return e.averageResponseTime=s>0?t/s:0,e}getRetentionAnalysis(){let e=new Date,t=new Map;for(let[s,i]of this.retentionData){let s=i.cohortDate.toISOString().split("T")[0];t.has(s)||t.set(s,{cohortId:s,cohortDate:i.cohortDate,totalUsers:0,retentionRates:{day1:0,day7:0,day14:0,day30:0,day60:0,day90:0},averageEngagement:0,topFeatures:[],churnPatterns:[]});let a=t.get(s);a.totalUsers++;let n=Math.floor((e.getTime()-i.cohortDate.getTime())/864e5),r=Math.floor((e.getTime()-i.lastActiveDate.getTime())/864e5);n>=1&&r<=1&&a.retentionRates.day1++,n>=7&&r<=7&&a.retentionRates.day7++,n>=14&&r<=14&&a.retentionRates.day14++,n>=30&&r<=30&&a.retentionRates.day30++,n>=60&&r<=60&&a.retentionRates.day60++,n>=90&&r<=90&&a.retentionRates.day90++}for(let e of t.values())e.retentionRates.day1=e.retentionRates.day1/e.totalUsers*100,e.retentionRates.day7=e.retentionRates.day7/e.totalUsers*100,e.retentionRates.day14=e.retentionRates.day14/e.totalUsers*100,e.retentionRates.day30=e.retentionRates.day30/e.totalUsers*100,e.retentionRates.day60=e.retentionRates.day60/e.totalUsers*100,e.retentionRates.day90=e.retentionRates.day90/e.totalUsers*100;return Array.from(t.values())}getNotificationEffectiveness(){let e={totalSent:0,deliveryRate:0,openRate:0,clickRate:0,byType:{},byCategory:{},optimalSendTimes:[]},t=0,s=0,i=0;for(let[a,n]of this.notificationMetrics)for(let a of n)e.totalSent++,"delivered"===a.deliveryStatus&&t++,a.isOpened&&s++,a.isClicked&&i++,e.byType[a.type]||(e.byType[a.type]={sent:0,opened:0,clicked:0}),e.byType[a.type].sent++,a.isOpened&&e.byType[a.type].opened++,a.isClicked&&e.byType[a.type].clicked++,e.byCategory[a.category]||(e.byCategory[a.category]={sent:0,opened:0,clicked:0}),e.byCategory[a.category].sent++,a.isOpened&&e.byCategory[a.category].opened++,a.isClicked&&e.byCategory[a.category].clicked++;return e.deliveryRate=e.totalSent>0?t/e.totalSent*100:0,e.openRate=t>0?s/t*100:0,e.clickRate=s>0?i/s*100:0,e}updateEngagementScore(e){var t,s,i,a;let n=new Date,r=new Date(n.getTime()-2592e6),o=Array.from(this.sessions.values()).filter(t=>t.userId===e&&t.startTime>=r),c=(null===(t=this.featureUsage.get(e))||void 0===t?void 0:t.filter(e=>e.timestamp>=r))||[],l=(null===(s=this.contentInteractions.get(e))||void 0===s?void 0:s.filter(e=>e.timestamp>=r))||[],p=(null===(i=this.assessmentTracking.get(e))||void 0===i?void 0:i.filter(e=>e.startTime>=r))||[],g=(null===(a=this.peerSupportMetrics.get(e))||void 0===a?void 0:a.filter(e=>e.timestamp>=r))||[],m={dailyCheckins:this.calculateDailyCheckinsScore(e,r),assessments:this.calculateAssessmentsScore(p),education:this.calculateEducationScore(l),peerSupport:this.calculatePeerSupportScore(g),resourceUsage:this.calculateResourceUsageScore(c),appUsage:this.calculateAppUsageScore(o)},u={dailyCheckins:.25,assessments:.2,education:.15,peerSupport:.15,resourceUsage:.1,appUsage:.15},d=Object.entries(m).reduce((e,t)=>{let[s,i]=t;return e+i*u[s]},0),h=this.engagementScores.get(e)||[],y="stable";if(h.length>0){let e=h[h.length-1].overallScore;d>e+5?y="increasing":d<e-5&&(y="decreasing")}let f={userId:e,date:n,overallScore:Math.round(d),categoryScores:m,trend:y,factors:this.getEngagementFactors(m),recommendations:this.getEngagementRecommendations(m,y)};h.push(f),this.engagementScores.set(e,h),this.emit("engagementScoreUpdated",f)}calculateDailyCheckinsScore(e,t){return 75}calculateAssessmentsScore(e){let t=e.filter(e=>e.isCompleted).length,s=e.length;return s>0?t/s*100:0}calculateEducationScore(e){let t=e.filter(e=>"complete"===e.action).length,s=e.filter(e=>"view"===e.action).length;return s>0?t/s*100:0}calculatePeerSupportScore(e){return Math.min(10*e.filter(e=>"support-given"===e.activityType).length,100)}calculateResourceUsageScore(e){return Math.min(20*new Set(e.map(e=>e.feature)).size,100)}calculateAppUsageScore(e){return Math.min(e.reduce((e,t)=>e+(t.duration||0),0)/30/10,100)}getEngagementFactors(e){let t=[];return e.dailyCheckins>80&&t.push("Consistent daily check-ins"),e.assessments>70&&t.push("Regular assessment completion"),e.education>60&&t.push("Active learning engagement"),e.peerSupport>50&&t.push("Supportive community member"),e.resourceUsage>40&&t.push("Diverse resource utilization"),e.appUsage>70&&t.push("High app engagement"),t}getEngagementRecommendations(e,t){let s=[];return e.dailyCheckins<50&&s.push("Try setting daily check-in reminders"),e.assessments<40&&s.push("Complete mental health assessments regularly"),e.education<30&&s.push("Explore educational content"),e.peerSupport<25&&s.push("Join peer support groups"),e.resourceUsage<20&&s.push("Browse available resources"),"decreasing"===t&&s.push("Consider reaching out for additional support"),s}startPeriodicTasks(){setInterval(()=>{this.updateAllEngagementScores()},864e5),setInterval(()=>{this.cleanOldData()},6048e5)}updateAllEngagementScores(){let e=new Set;for(let t of this.sessions.values())e.add(t.userId);for(let t of e)this.updateEngagementScore(t)}cleanOldData(){let e=new Date;for(let[t,s]of(e.setDate(e.getDate()-90),this.sessions))s.startTime<e&&this.sessions.delete(t);for(let[t,s]of this.userInteractions){let i=s.filter(t=>t.timestamp>=e);this.userInteractions.set(t,i)}}getAnalyticsDashboard(){return{activeUsers:{daily:this.getDailyActiveUsers(),weekly:this.getWeeklyActiveUsers(),monthly:this.getMonthlyActiveUsers()},featureUsage:this.getFeatureUsagePatterns(),contentInteraction:this.getContentInteractionRates(),assessmentCompletion:this.getAssessmentCompletionRates(),peerSupportParticipation:this.getPeerSupportParticipation(),retentionAnalysis:this.getRetentionAnalysis(),notificationEffectiveness:this.getNotificationEffectiveness()}}constructor(){super(),this.sessions=new Map,this.userInteractions=new Map,this.featureUsage=new Map,this.contentInteractions=new Map,this.assessmentTracking=new Map,this.peerSupportMetrics=new Map,this.notificationMetrics=new Map,this.retentionData=new Map,this.engagementScores=new Map,this.startPeriodicTasks()}}let n=new a}}]);