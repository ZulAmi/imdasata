(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[645],{3454:function(e,t,a){"use strict";var r,s;e.exports=(null==(r=a.g.process)?void 0:r.env)&&"object"==typeof(null==(s=a.g.process)?void 0:s.env)?a.g.process:a(7663)},645:function(e,t,a){"use strict";var r=a(3454);class s{addResource(e){e.id||(e.id="resource_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))),e.lastUpdated=new Date().toISOString(),e.qrCode=this.generateQRCode(e),this.resources.set(e.id,e),this.updateSearchIndex(e),this.feedback.set(e.id,[]),this.initializeUtilizationTracking(e.id)}updateResource(e,t){let a=this.resources.get(e);if(!a)return!1;let r={...a,...t};return r.lastUpdated=new Date().toISOString(),(t.contactInfo||t.name)&&(r.qrCode=this.generateQRCode(r)),this.resources.set(e,r),this.updateSearchIndex(r),!0}searchResources(e,t){let a=[];for(let r of this.resources.values()){if("active"!==r.status)continue;let s=this.matchResourceToFilter(r,e,t);s.matches&&a.push({resource:r,relevanceScore:s.score,distance:s.distance,matchedFields:s.matchedFields,isCurrentlyOpen:this.isResourceCurrentlyOpen(r),nextAvailableTime:this.getNextAvailableTime(r)})}return this.sortSearchResults(a,e.sortBy||"rating",e.sortOrder||"desc")}getResource(e){return this.resources.get(e)||null}getResourcesByCategory(e){return Array.from(this.resources.values()).filter(t=>t.category===e&&"active"===t.status)}addFeedback(e){let t="feedback_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),a={...e,id:t,submittedAt:new Date().toISOString(),isVerified:!1},r=this.feedback.get(e.resourceId)||[];return r.push(a),this.feedback.set(e.resourceId,r),this.updateResourceQualityMetrics(e.resourceId),t}trackUtilization(e,t,a){let r=new Date().toISOString().split("T")[0],s=this.utilization.get(e)||[],n=s.find(e=>e.date===r);switch(n||(n={resourceId:e,date:r,metrics:{views:0,contacts:0,qr_scans:0,referrals:0,feedback_count:0,avg_rating:0},demographicBreakdown:{by_country:{},by_age_group:{},by_employment:{},by_language:{}}},s.push(n)),t){case"view":n.metrics.views++;break;case"contact":n.metrics.contacts++;break;case"qr_scan":n.metrics.qr_scans++;break;case"referral":n.metrics.referrals++}a&&(a.country&&(n.demographicBreakdown.by_country[a.country]=(n.demographicBreakdown.by_country[a.country]||0)+1),a.ageGroup&&(n.demographicBreakdown.by_age_group[a.ageGroup]=(n.demographicBreakdown.by_age_group[a.ageGroup]||0)+1),a.employment&&(n.demographicBreakdown.by_employment[a.employment]=(n.demographicBreakdown.by_employment[a.employment]||0)+1),a.language&&(n.demographicBreakdown.by_language[a.language]=(n.demographicBreakdown.by_language[a.language]||0)+1)),this.utilization.set(e,s)}getResourceAnalytics(e,t){let a=this.utilization.get(e)||[],r=this.feedback.get(e)||[],s=a;t&&(s=a.filter(e=>e.date>=t.start&&e.date<=t.end));let n=s.reduce((e,t)=>(e.views+=t.metrics.views,e.contacts+=t.metrics.contacts,e.qr_scans+=t.metrics.qr_scans,e.referrals+=t.metrics.referrals,e),{views:0,contacts:0,qr_scans:0,referrals:0});return{resourceId:e,period:t||"all_time",totalMetrics:n,averageRating:r.length>0?r.reduce((e,t)=>e+t.rating,0)/r.length:0,totalFeedback:r.length,dailyBreakdown:s,topDemographics:this.calculateTopDemographics(s),conversionRate:n.views>0?n.contacts/n.views:0,trendAnalysis:this.calculateTrends(s)}}generateQRCode(e){let t=r.env.NEXT_PUBLIC_BASE_URL||"http://localhost:3000",a="".concat(t,"/resources/").concat(e.id),s="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=".concat(encodeURIComponent(a));return{url:a,imageUrl:s,generatedAt:new Date().toISOString()}}isResourceCurrentlyOpen(e){let t=new Date,a=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][t.getDay()],r=t.toTimeString().slice(0,5),s=e.schedule.find(e=>e.day===a);return!!s&&!!s.isOpen&&s.timeSlots.some(e=>r>=e.start&&r<=e.end)}getNextAvailableTime(e){let t=new Date,a=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];for(let r=0;r<7;r++){let s=new Date(t);s.setDate(t.getDate()+r);let n=a[s.getDay()],i=e.schedule.find(e=>e.day===n);if((null==i?void 0:i.isOpen)&&i.timeSlots.length>0){let e=i.timeSlots[0];if(0===r){let e=t.toTimeString().slice(0,5),a=i.timeSlots.find(t=>t.start>e);if(a)return"Today at ".concat(a.start)}else{let t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return"".concat(t[s.getDay()]," at ").concat(e.start)}}}}matchResourceToFilter(e,t,a){var r,s;let n;let i=0,o=[];if(t.categories&&!t.categories.includes(e.category))return{matches:!1,score:0,matchedFields:[]};if((null===(r=t.categories)||void 0===r?void 0:r.includes(e.category))&&(i+=20,o.push("category")),t.languages){if(!t.languages.some(t=>e.targetGroups.languages.includes(t)))return{matches:!1,score:0,matchedFields:[]};i+=15,o.push("language")}if(t.location&&a&&(null===(s=e.location)||void 0===s?void 0:s.coordinates)){if(n=this.calculateDistance(a.lat,a.lng,e.location.coordinates.latitude,e.location.coordinates.longitude),t.location.maxDistance&&n>t.location.maxDistance)return{matches:!1,score:0,matchedFields:[]};i+=Math.max(0,20-n/5),o.push("location")}if(t.cost){if(!e.servicesOffered.some(e=>t.cost.includes(e.cost)))return{matches:!1,score:0,matchedFields:[]};i+=10,o.push("cost")}if(t.features){let a=0,r=0;if(Object.entries(t.features).forEach(t=>{let[s,n]=t;n&&(r++,"wheelchairAccessible"===s&&e.accessibility.wheelchairAccessible&&a++,"acceptsWalkIns"===s&&e.accessibility.acceptsWalkIns&&a++,"hasOnlineOption"===s&&e.features.hasOnlineOption&&a++,"has24HourSupport"===s&&e.features.has24HourSupport&&a++,"providesCrisisIntervention"===s&&e.features.providesCrisisIntervention&&a++)}),r>0&&0===a)return{matches:!1,score:0,matchedFields:[]};a>0&&(i+=a/r*15,o.push("features"))}if(t.rating){if(t.rating.minRating&&e.qualityMetrics.averageRating<t.rating.minRating||t.rating.minReviews&&e.qualityMetrics.totalReviews<t.rating.minReviews)return{matches:!1,score:0,matchedFields:[]};i+=2*e.qualityMetrics.averageRating,o.push("rating")}if(t.searchQuery){let a=this.calculateSearchQueryScore(e,t.searchQuery);if(0===a)return{matches:!1,score:0,matchedFields:[]};i+=a,o.push("search")}if(t.targetGroups){let a=0;t.targetGroups.countries&&t.targetGroups.countries.some(t=>{var a;return null===(a=e.targetGroups.countries)||void 0===a?void 0:a.includes(t)})&&(a+=5),t.targetGroups.employmentSectors&&t.targetGroups.employmentSectors.some(t=>{var a;return null===(a=e.targetGroups.employmentSectors)||void 0===a?void 0:a.includes(t)})&&(a+=5),i+=a,a>0&&o.push("targetGroups")}return{matches:!0,score:i,distance:n,matchedFields:o}}calculateSearchQueryScore(e,t){var a;let r=t.toLowerCase(),s=0;return e.name.en.toLowerCase().includes(r)&&(s+=30),e.description.en.toLowerCase().includes(r)&&(s+=20),e.servicesOffered.forEach(e=>{e.service.en.toLowerCase().includes(r)&&(s+=15)}),(null===(a=e.searchKeywords.en)||void 0===a?void 0:a.some(e=>e.toLowerCase().includes(r)))&&(s+=10),e.tags.some(e=>e.toLowerCase().includes(r))&&(s+=10),s}calculateDistance(e,t,a,r){let s=(a-e)*Math.PI/180,n=(r-t)*Math.PI/180,i=Math.sin(s/2)*Math.sin(s/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*6371}sortSearchResults(e,t,a){return e.sort((e,r)=>{let s=0;switch(t){case"rating":s=e.resource.qualityMetrics.averageRating-r.resource.qualityMetrics.averageRating;break;case"distance":s=(e.distance||0)-(r.distance||0);break;case"name":s=e.resource.name.en.localeCompare(r.resource.name.en);break;case"recently_added":s=new Date(e.resource.lastUpdated).getTime()-new Date(r.resource.lastUpdated).getTime();break;case"availability":s=(e.isCurrentlyOpen?1:0)-(r.isCurrentlyOpen?1:0);break;default:s=r.relevanceScore-e.relevanceScore}return"desc"===a?-s:s})}updateSearchIndex(e){[...e.name.en.toLowerCase().split(/\s+/),...e.description.en.toLowerCase().split(/\s+/),...e.tags.map(e=>e.toLowerCase()),...(e.searchKeywords.en||[]).map(e=>e.toLowerCase())].forEach(t=>{t.length>2&&(this.searchIndex.has(t)||this.searchIndex.set(t,new Set),this.searchIndex.get(t).add(e.id))})}buildSearchIndex(){for(let e of(this.searchIndex.clear(),this.resources.values()))this.updateSearchIndex(e)}updateResourceQualityMetrics(e){let t=this.resources.get(e),a=this.feedback.get(e);if(!t||!a||0===a.length)return;let r=a.reduce((e,t)=>e+t.rating,0)/a.length;t.qualityMetrics.averageRating=Math.round(10*r)/10,t.qualityMetrics.totalReviews=a.length,t.lastUpdated=new Date().toISOString(),this.resources.set(e,t)}initializeUtilizationTracking(e){this.utilization.has(e)||this.utilization.set(e,[])}calculateTopDemographics(e){let t={},a={},r={},s={};return e.forEach(e=>{Object.entries(e.demographicBreakdown.by_country).forEach(e=>{let[a,r]=e;t[a]=(t[a]||0)+r}),Object.entries(e.demographicBreakdown.by_age_group).forEach(e=>{let[t,r]=e;a[t]=(a[t]||0)+r}),Object.entries(e.demographicBreakdown.by_employment).forEach(e=>{let[t,a]=e;r[t]=(r[t]||0)+a}),Object.entries(e.demographicBreakdown.by_language).forEach(e=>{let[t,a]=e;s[t]=(s[t]||0)+a})}),{topCountry:this.getTopEntry(t),topAgeGroup:this.getTopEntry(a),topEmployment:this.getTopEntry(r),topLanguage:this.getTopEntry(s)}}getTopEntry(e){let t=Object.entries(e);if(0===t.length)return null;let a=t.sort((e,t)=>{let[,a]=e,[,r]=t;return r-a});return{key:a[0][0],value:a[0][1]}}calculateTrends(e){if(e.length<2)return null;let t=e.sort((e,t)=>e.date.localeCompare(t.date)),a=t.slice(-7),r=t.slice(-14,-7),s=a.reduce((e,t)=>e+t.metrics.views,0)/a.length,n=r.length>0?r.reduce((e,t)=>e+t.metrics.views,0)/r.length:0,i=n>0?(s-n)/n*100:0;return{viewsTrend:i,direction:i>5?"increasing":i<-5?"decreasing":"stable",recentAverage:s,previousAverage:n}}initializeSampleResources(){[{id:"dormitory_001",name:{en:"Dormitory Mental Health Support Hub",zh:"宿舍心理健康支援中心",bn:"ডরমিটরি মানসিক স্বাস্থ্য সহায়তা কেন্দ্র",ta:"தங்குமிட மன நல ஆதரவு மையம்",my:"Pusat Sokongan Kesihatan Mental Asrama",idn:"Pusat Dukungan Kesehatan Mental Asrama"},description:{en:"On-site mental health support available in worker dormitories with trained peer counselors and regular check-ins.",zh:"在工人宿舍提供现场心理健康支持，配备训练有素的同伴咨询师和定期检查。",bn:"প্রশিক্ষিত সহকর্মী পরামর্শদাতা এবং নিয়মিত চেক-ইনের সাথে শ্রমিক হোস্টেলে অন-সাইট মানসিক স্বাস্থ্য সহায়তা উপলব্ধ।",ta:"பயிற்சி பெற்ற சகாக்களின் ஆலோசকர்கள் மற்றும் வழக்கமான சோதனைகளுடன் தொழிலாளர் விடுதிகளில் நேரில் மன நல ஆதரவு கிடைக்கிறது।",my:"Sokongan kesihatan mental di tapak tersedia di asrama pekerja dengan kaunselor rakan sebaya yang terlatih dan pemeriksaan berkala.",idn:"Dukungan kesehatan mental di tempat tersedia di asrama pekerja dengan konselor sebaya terlatih dan pemeriksaan rutin."},category:"dormitory-based",contactInfo:[{method:"phone",value:"+65-6234-5678",isPrimary:!0,description:"Main helpline - 24/7",languages:["en","zh","bn","ta"]},{method:"whatsapp",value:"+65-9234-5678",isPrimary:!1,description:"WhatsApp support",languages:["en","bn","ta","my","idn"]}],location:{address:{en:"Block 123, Dormitory Complex, Industrial Area",zh:"工业区宿舍群123栋",bn:"ব্লক ১২৩, হোস্টেল কমপ্লেক্স, শিল্প এলাকা",ta:"பிளாக் 123, விடுதி வளாகம், தொழில்துறை பகுதி",my:"Blok 123, Kompleks Asrama, Kawasan Perindustrian",idn:"Blok 123, Kompleks Asrama, Kawasan Industri"},coordinates:{latitude:1.3521,longitude:103.8198},nearbyLandmarks:{en:"Near MRT Station and Shopping Center",zh:"靠近地铁站和购物中心",bn:"এমআরটি স্টেশন এবং শপিং সেন্টারের কাছে",ta:"MRT நிலையம் மற்றும் வணிக மையத்திற்கு அருகில்",my:"Berhampiran Stesen MRT dan Pusat Membeli-belah",idn:"Dekat Stasiun MRT dan Pusat Perbelanjaan"},transportationInfo:{en:"Free shuttle bus every 30 minutes",zh:"每30分钟免费班车",bn:"প্রতি ৩০ মিনিটে বিনামূল্যে শাটল বাস",ta:"ஒவ்வொரு 30 நிமிடங்களுக்கும் இலவச ஷட்டில் பேருந்து",my:"Bas ulang-alik percuma setiap 30 minit",idn:"Bus antar jemput gratis setiap 30 menit"}},schedule:[{day:"monday",isOpen:!0,timeSlots:[{start:"09:00",end:"17:00"},{start:"19:00",end:"21:00"}]},{day:"tuesday",isOpen:!0,timeSlots:[{start:"09:00",end:"17:00"},{start:"19:00",end:"21:00"}]},{day:"wednesday",isOpen:!0,timeSlots:[{start:"09:00",end:"17:00"},{start:"19:00",end:"21:00"}]},{day:"thursday",isOpen:!0,timeSlots:[{start:"09:00",end:"17:00"},{start:"19:00",end:"21:00"}]},{day:"friday",isOpen:!0,timeSlots:[{start:"09:00",end:"17:00"},{start:"19:00",end:"21:00"}]},{day:"saturday",isOpen:!0,timeSlots:[{start:"10:00",end:"16:00"}]},{day:"sunday",isOpen:!0,timeSlots:[{start:"10:00",end:"16:00"}]}],timezone:"Asia/Singapore",servicesOffered:[{service:{en:"Peer Counseling",zh:"同伴咨询",bn:"সহকর্মী পরামর্শ",ta:"சகா ஆலோசனை",my:"Kaunseling Rakan Sebaya",idn:"Konseling Sebaya"},description:{en:"One-on-one support from trained peer counselors who understand migrant worker experiences",zh:"来自了解移工经历的训练有素的同伴咨询师的一对一支持",bn:"প্রবাসী শ্রমিকদের অভিজ্ঞতা বোঝেন এমন প্রশিক্ষিত সহকর্মী পরামর্শদাতাদের কাছ থেকে এক-এর-পর-এক সহায়তা",ta:"புலம்பெயர்ந்த தொழிலாளர்களின் அனுபவங்களைப் புரிந்து கொள்ளும் பயிற்சி பெற்ற சகாக்களின் ஆலோசকர்களிடமிருந்து ஒருவருக்கு ஒருவர் ஆதரவு",my:"Sokongan satu dengan satu daripada kaunselor rakan sebaya terlatih yang memahami pengalaman pekerja migran",idn:"Dukungan satu lawan satu dari konselor sebaya terlatih yang memahami pengalaman pekerja migran"},languages:["en","zh","bn","ta","my","idn"],cost:"free",requiresAppointment:!1,duration:"30-60 minutes"}],targetGroups:{countries:["Bangladesh","India","China","Philippines","Indonesia","Myanmar"],ageGroups:["18-25","26-35","36-45","46-55"],employmentSectors:["Construction","Manufacturing"],languages:["en","zh","bn","ta","my","idn"],riskLevels:["minimal","mild","moderate"],specificNeeds:["homesickness","work stress","social isolation"]},provider:{name:{en:"Worker Welfare Organization",zh:"工人福利组织",bn:"শ্রমিক কল্যাণ সংস্থা",ta:"தொழிலாளர் நல அமைப்பு",my:"Organisasi Kebajikan Pekerja",idn:"Organisasi Kesejahteraan Pekerja"},type:"ngo",credentials:["Certified Peer Counselors","Mental Health First Aid"],website:"https://workersdormitorysupport.org"},qualityMetrics:{averageRating:4.2,totalReviews:89,responseTime:"immediate",waitTime:"no wait"},status:"active",verificationStatus:"verified",lastUpdated:new Date().toISOString(),addedBy:"admin_001",accessibility:{wheelchairAccessible:!0,hasTranslationServices:!0,acceptsWalkIns:!0,requiresReferral:!1,costInfo:{en:"Completely free service for all dormitory residents",zh:"为所有宿舍居民提供完全免费的服务",bn:"সকল হোস্টেল বাসিন্দাদের জন্য সম্পূর্ণ বিনামূল্যে সেবা",ta:"அனைத்து விடுதி குடியிருப்பாளர்களுக்கும் முற்றிலும் இலவச சேவை",my:"Perkhidmatan percuma sepenuhnya untuk semua penghuni asrama",idn:"Layanan sepenuhnya gratis untuk semua penghuni asrama"}},features:{hasChildcare:!1,providesTransportation:!1,hasOnlineOption:!0,has24HourSupport:!0,providesFollowUp:!0,hasGroupSessions:!0,hasIndividualSessions:!0,providesCrisisIntervention:!0},searchKeywords:{en:["dormitory","peer support","on-site","worker housing","counseling","mental health"],zh:["宿舍","同伴支持","现场","工人住房","咨询","心理健康"],bn:["হোস্টেল","সহকর্মী সহায়তা","অন-সাইট","শ্রমিক আবাসন","পরামর্শ","মানসিক স্বাস্থ্য"],ta:["விடுதி","சகா ஆதரவு","நேரில்","தொழிலாளர் வீட்டுவசதி","ஆலோசனை","மன நலம்"],my:["asrama","sokongan rakan sebaya","di tapak","perumahan pekerja","kaunseling","kesihatan mental"],idn:["asrama","dukungan sebaya","di tempat","perumahan pekerja","konseling","kesehatan mental"]},tags:["dormitory","peer-support","on-site","multilingual","free","24-7"]}].forEach(e=>{this.addResource(e)})}getAllResources(){return Array.from(this.resources.values())}deleteResource(e){let t=this.resources.delete(e);return t&&(this.feedback.delete(e),this.utilization.delete(e)),t}getResourceStatistics(){let e=Array.from(this.resources.values()),t=new Map,a=0,r=0;return e.forEach(e=>{t.set(e.category,(t.get(e.category)||0)+1),a+=e.qualityMetrics.averageRating*e.qualityMetrics.totalReviews,r+=e.qualityMetrics.totalReviews}),{totalResources:e.length,activeResources:e.filter(e=>"active"===e.status).length,categoriesBreakdown:Object.fromEntries(t),averageRating:r>0?a/r:0,totalReviews:r,verifiedResources:e.filter(e=>"verified"===e.verificationStatus).length}}constructor(){this.resources=new Map,this.feedback=new Map,this.utilization=new Map,this.searchIndex=new Map,this.initializeSampleResources(),this.buildSearchIndex()}}t.Z=s},7663:function(e){!function(){var t={229:function(e){var t,a,r,s=e.exports={};function n(){throw Error("setTimeout has not been defined")}function i(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(a){try{return t.call(null,e,0)}catch(a){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{a="function"==typeof clearTimeout?clearTimeout:i}catch(e){a=i}}();var c=[],l=!1,u=-1;function d(){l&&r&&(l=!1,r.length?c=r.concat(c):u=-1,c.length&&h())}function h(){if(!l){var e=o(d);l=!0;for(var t=c.length;t;){for(r=c,c=[];++u<t;)r&&r[u].run();u=-1,t=c.length}r=null,l=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===i||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function p(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];c.push(new g(e,t)),1!==c.length||l||o(h)},g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=p,s.addListener=p,s.once=p,s.off=p,s.removeListener=p,s.removeAllListeners=p,s.emit=p,s.prependListener=p,s.prependOnceListener=p,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}}},a={};function r(e){var s=a[e];if(void 0!==s)return s.exports;var n=a[e]={exports:{}},i=!0;try{t[e](n,n.exports,r),i=!1}finally{i&&delete a[e]}return n.exports}r.ab="//";var s=r(229);e.exports=s}()}}]);