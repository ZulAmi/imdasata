"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[193],{1193:function(e,s,l){var t=l(5893),a=l(7294),r=l(3923);s.Z=e=>{var s,l,i,d;let{userId:n,initialUser:c}=e,[o,x]=(0,a.useState)(c||null),[m,h]=(0,a.useState)("dashboard"),[b,u]=(0,a.useState)([]),[g,v]=(0,a.useState)([]),[j,p]=(0,a.useState)([]),[N,y]=(0,a.useState)([]),[f,w]=(0,a.useState)(null),[D,C]=(0,a.useState)(null),[k,S]=(0,a.useState)(null),[L,A]=(0,a.useState)(!1),[P,R]=(0,a.useState)({show:!1,level:0}),[E,I]=(0,a.useState)({show:!1}),F=(0,a.useRef)();(0,a.useEffect)(()=>(T(),q(),()=>{r.b.removeAllListeners(),F.current&&clearTimeout(F.current)}),[n]);let T=()=>{var e;let s=r.b.getUser(n);s||(s=r.b.createUser({userId:n,username:"User_".concat(n.slice(-6)),email:void 0})),x(s),u((null===(e=r.b.getTransactions(n))||void 0===e?void 0:e.slice(0,20))||[]),v(s.achievements),p(r.b.getAvailableRewards(n)),y(r.b.getLeaderboard("all-time",10)),w(r.b.getUserStats(n))},q=()=>{r.b.on("pointsAwarded",e=>{e.userId===n&&(T(),U(e.amount))}),r.b.on("levelUp",e=>{e.user.userId===n&&(R({show:!0,level:e.newLevel,levelInfo:e.levelInfo}),setTimeout(()=>{R({show:!1,level:0})},4e3),T())}),r.b.on("achievementUnlocked",e=>{e.user.userId===n&&(I({show:!0,achievement:e.achievement}),setTimeout(()=>{I({show:!1})},5e3),T())}),r.b.on("rewardRedeemed",e=>{e.user.userId===n&&(S(e.redemption),A(!0),T())})},U=e=>{console.log("+".concat(e," points earned!"))},Y=async e=>{if(!o||o.availablePoints<e.pointCost){alert("Insufficient points!");return}try{let s=await r.b.redeemReward(n,e.id);s&&(S(s),A(!0),C(null),T())}catch(e){alert("Failed to redeem reward. Please try again.")}};return o?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-6xl mx-auto px-4 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"\uD83C\uDFAE Gamification"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Track your progress and earn rewards"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"font-semibold text-lg",children:[o.availablePoints.toLocaleString()," \uD83D\uDC8E"]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Available Points"})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"font-semibold text-lg",children:["Level ",o.currentLevel," ",null==f?void 0:null===(s=f.level)||void 0===s?void 0:s.badge]}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:null==f?void 0:null===(l=f.level)||void 0===l?void 0:l.name})]})]})]})})}),(0,t.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,t.jsx)("nav",{className:"flex space-x-8",children:[{id:"dashboard",label:"Dashboard",icon:"\uD83C\uDFE0"},{id:"achievements",label:"Achievements",icon:"\uD83C\uDFC6"},{id:"rewards",label:"Rewards",icon:"\uD83C\uDF81"},{id:"leaderboard",label:"Leaderboard",icon:"\uD83C\uDFC5"},{id:"stats",label:"Statistics",icon:"\uD83D\uDCCA"}].map(e=>(0,t.jsxs)("button",{onClick:()=>h(e.id),className:"py-4 px-2 border-b-2 font-medium text-sm transition-colors ".concat(m===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,t.jsx)("span",{className:"mr-2",children:e.icon}),e.label]},e.id))})})}),(0,t.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-6",children:["dashboard"===m&&(()=>{if(!o||!f)return null;let e=f.level,s=f.nextLevel,l=s?(o.totalPoints-e.pointsRequired)/(s.pointsRequired-e.pointsRequired)*100:100;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl p-6 text-white",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:(null==e?void 0:e.name)||"Newcomer"}),(0,t.jsxs)("p",{className:"text-blue-100",children:["Level ",o.currentLevel]})]}),(0,t.jsx)("div",{className:"text-4xl",children:(null==e?void 0:e.badge)||"\uD83C\uDF31"})]}),s&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{children:["Progress to ",s.name]}),(0,t.jsxs)("span",{children:[f.pointsToNextLevel," points to go"]})]}),(0,t.jsx)("div",{className:"w-full bg-blue-400 rounded-full h-3",children:(0,t.jsx)("div",{className:"bg-white rounded-full h-3 transition-all duration-500",style:{width:"".concat(Math.max(l,5),"%")}})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-md border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Available Points"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-green-600",children:o.availablePoints.toLocaleString()})]}),(0,t.jsx)("div",{className:"text-green-500 text-2xl",children:"\uD83D\uDC8E"})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-md border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Total Earned"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:o.lifetimePoints.toLocaleString()})]}),(0,t.jsx)("div",{className:"text-blue-500 text-2xl",children:"⭐"})]})}),(0,t.jsx)("div",{className:"bg-white rounded-lg p-4 shadow-md border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-600 text-sm",children:"Current Streak"}),(0,t.jsxs)("p",{className:"text-2xl font-bold text-orange-600",children:[o.currentStreak," days"]})]}),(0,t.jsx)("div",{className:"text-orange-500 text-2xl",children:"\uD83D\uDD25"})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-md border border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Recent Activity"}),(0,t.jsx)("div",{className:"space-y-3",children:b.slice(0,5).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-2 h-2 rounded-full ".concat("earn"===e.type?"bg-green-500":"bg-red-500")}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:e.description}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[e.timestamp.toLocaleDateString()," at ",e.timestamp.toLocaleTimeString()]})]})]}),(0,t.jsxs)("div",{className:"font-semibold ".concat("earn"===e.type?"text-green-600":"text-red-600"),children:["earn"===e.type?"+":"-",Math.abs(e.amount)]})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-md border border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Quick Actions"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("button",{onClick:()=>{r.b.recordDailyCheckIn(n,8,"Feeling good today!")},className:"p-4 bg-green-50 rounded-lg border border-green-200 hover:bg-green-100 transition-colors",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:"✅"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:"Daily Check-in"})]}),(0,t.jsxs)("button",{onClick:()=>{r.b.recordAssessment(n,"PHQ-4",8)},className:"p-4 bg-blue-50 rounded-lg border border-blue-200 hover:bg-blue-100 transition-colors",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCCA"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:"Take Assessment"})]}),(0,t.jsxs)("button",{onClick:()=>{r.b.recordEducationalEngagement(n,"article",300)},className:"p-4 bg-purple-50 rounded-lg border border-purple-200 hover:bg-purple-100 transition-colors",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDCDA"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:"Learn Something"})]}),(0,t.jsxs)("button",{onClick:()=>{r.b.recordPeerSupportActivity(n,"support-given",5)},className:"p-4 bg-orange-50 rounded-lg border border-orange-200 hover:bg-orange-100 transition-colors",children:[(0,t.jsx)("div",{className:"text-2xl mb-2",children:"\uD83E\uDD1D"}),(0,t.jsx)("div",{className:"text-sm font-medium",children:"Help Others"})]})]})]})]})})(),"achievements"===m&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-md border border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Your Achievements"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[g.map(e=>(0,t.jsxs)("div",{className:"p-4 rounded-lg border-2 ".concat("legendary"===e.rarity?"border-yellow-300 bg-yellow-50":"epic"===e.rarity?"border-purple-300 bg-purple-50":"rare"===e.rarity?"border-blue-300 bg-blue-50":"border-gray-300 bg-gray-50"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("div",{className:"text-2xl",children:e.icon}),(0,t.jsx)("div",{className:"text-xs px-2 py-1 rounded ".concat("legendary"===e.rarity?"bg-yellow-200 text-yellow-800":"epic"===e.rarity?"bg-purple-200 text-purple-800":"rare"===e.rarity?"bg-blue-200 text-blue-800":"bg-gray-200 text-gray-800"),children:e.rarity.toUpperCase()})]}),(0,t.jsx)("h4",{className:"font-semibold",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("span",{className:"text-sm font-medium text-green-600",children:["+",e.points," points"]}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:e.unlockedAt.toLocaleDateString()})]})]},e.id)),0===g.length&&(0,t.jsxs)("div",{className:"col-span-full text-center py-8 text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"\uD83C\uDFC6"}),(0,t.jsx)("p",{children:"No achievements yet. Start engaging to unlock them!"})]})]})]})}),"rewards"===m&&(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-md border border-gray-200",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold",children:"Available Rewards"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["You have ",null==o?void 0:o.availablePoints.toLocaleString()," points to spend"]})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(e=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("div",{className:"text-3xl",children:e.icon}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"font-semibold text-blue-600",children:[e.pointCost," points"]}),"limited"===e.availability&&void 0!==e.stock&&(0,t.jsxs)("div",{className:"text-xs text-orange-600",children:[e.stock," left"]})]})]}),(0,t.jsx)("h4",{className:"font-semibold mb-2",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:e.description}),e.requirements&&(0,t.jsx)("div",{className:"mb-3 text-xs text-gray-500",children:e.requirements.minLevel&&(0,t.jsxs)("div",{children:["Requires Level ",e.requirements.minLevel,"+"]})}),(0,t.jsx)("button",{onClick:()=>Y(e),disabled:!o||o.availablePoints<e.pointCost,className:"w-full py-2 px-4 rounded-md font-medium transition-colors ".concat(o&&o.availablePoints>=e.pointCost?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:o&&o.availablePoints>=e.pointCost?"Redeem":"Insufficient Points"})]},e.id))}),0===j.length&&(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"\uD83C\uDF81"}),(0,t.jsx)("p",{children:"No rewards available at your current level."})]})]})}),"leaderboard"===m&&(()=>{let e=N.findIndex(e=>e.userId===n)+1;return(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-md border border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Leaderboard"}),e>0&&e<=10&&(0,t.jsx)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83C\uDF89 You're ranked #",e," on the leaderboard!"]})}),(0,t.jsx)("div",{className:"space-y-3",children:N.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-lg border ".concat(e.userId===n?"border-blue-300 bg-blue-50":"border-gray-200 bg-gray-50"),children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ".concat(1===e.rank?"bg-yellow-500":2===e.rank?"bg-gray-400":3===e.rank?"bg-amber-600":"bg-gray-500"),children:1===e.rank?"\uD83E\uDD47":2===e.rank?"\uD83E\uDD48":3===e.rank?"\uD83E\uDD49":e.rank}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold",children:e.username}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Level ",e.level," ",e.badge]})]})]}),(0,t.jsx)("div",{className:"text-right",children:(0,t.jsxs)("div",{className:"font-semibold text-blue-600",children:[e.points.toLocaleString()," points"]})})]},e.userId))}),e>10&&(0,t.jsx)("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["You're currently ranked #",e,". Keep engaging to climb higher!"]})})]})})})(),"stats"===m&&(f?(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"bg-white rounded-lg p-6 shadow-md border border-gray-200",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Your Statistics"}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Points by Category"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(f.categoryBreakdown).map(e=>{let[s,l]=e;return(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"capitalize",children:s.replace("-"," ")}),(0,t.jsxs)("span",{className:"font-semibold text-blue-600",children:[l," points"]})]},s)})})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Streaks"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.longestStreaks.map(e=>(0,t.jsxs)("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"capitalize",children:e.type.replace("-"," ")}),(0,t.jsxs)("span",{className:"font-semibold text-orange-600",children:[e.length," days"]})]},e.type))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium mb-3",children:"Overall Progress"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:f.totalTransactions}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Total Activities"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:f.achievements}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Achievements"})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:f.currentStreaks.length}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Active Streaks"})]})]})]})]})}):null)]}),P.show&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl p-8 text-center max-w-md mx-4 animate-bounce",children:[(0,t.jsx)("div",{className:"text-6xl mb-4",children:(null===(i=P.levelInfo)||void 0===i?void 0:i.badge)||"\uD83C\uDF89"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-blue-600 mb-2",children:"Level Up!"}),(0,t.jsxs)("p",{className:"text-lg mb-4",children:["You've reached Level ",P.level,"!"]}),(0,t.jsx)("p",{className:"text-gray-600",children:(null===(d=P.levelInfo)||void 0===d?void 0:d.name)||"New Level Achieved"}),(0,t.jsx)("div",{className:"mt-4 text-green-600 font-semibold",children:"+25 Bonus Points! \uD83C\uDF81"})]})}),E.show&&E.achievement&&(0,t.jsx)("div",{className:"fixed top-4 right-4 bg-white rounded-lg shadow-lg border border-gray-200 p-4 max-w-sm z-40 animate-slide-in-right",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"text-2xl",children:E.achievement.icon}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold",children:"Achievement Unlocked!"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:E.achievement.name}),(0,t.jsxs)("p",{className:"text-xs text-green-600",children:["+",E.achievement.points," points"]})]})]})}),L&&k&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl p-8 text-center max-w-md mx-4",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Reward Redeemed!"}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("img",{src:k.qrCode,alt:"QR Code",className:"mx-auto w-48 h-48 border border-gray-300 rounded-lg"})}),(0,t.jsxs)("p",{className:"text-gray-600 mb-4",children:["Show this QR code to redeem your reward.",(0,t.jsx)("br",{}),"Valid until: ",k.expiresAt.toLocaleDateString()]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("button",{onClick:()=>{let e=document.createElement("a");e.download="reward_".concat(k.id,".png"),e.href=k.qrCode,e.click()},className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition-colors",children:"Download QR Code"}),(0,t.jsx)("button",{onClick:()=>A(!1),className:"w-full bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400 transition-colors",children:"Close"})]})]})})]}):(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-4xl mb-4",children:"\uD83C\uDFAE"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading your gamification profile..."})]})})}}}]);